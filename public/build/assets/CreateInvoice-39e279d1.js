import{p as D,J as E,v as oe,x as le,m as ae,f as m,a as n,u as s,w as f,F as x,y as k,o as u,X as ne,b as e,t as h,e as re,g as V,i as c,q as N,z as P,s as _,d as p,c as H,l as j}from"./app-9d7a6545.js";import{_ as ie}from"./AuthenticatedLayout-1a28c797.js";import{_ as i}from"./InputError-67e0f4b1.js";import{_ as A}from"./PrimaryButton-2492944d.js";import{_ as Q}from"./DangerButton-523cd50d.js";import W from"./CreateEdit-e58fef0f.js";import{Z as R}from"./main-268770af.js";import{_ as d}from"./InputLabel-f284c4f9.js";import{h as de}from"./moment-a9aaa855.js";import{s as q}from"./multiselect-7a5cdb67.js";import ce from"./CreateCarrier-6a86316b.js";/* empty css                                                         */import"./index-4e86ce3d.js";import"./SecondaryButton-ccee137a.js";import"./SuccessButton-601b780c.js";const ue={class:"page-wrapper"},me={class:"page-content"},_e={class:"page-breadcrumb d-none d-sm-flex align-items-center mb-3"},pe=e("div",{class:"breadcrumb-title pe-3"},"Manage Shipments",-1),fe={class:"ps-3"},he={"aria-label":"breadcrumb"},ge={class:"breadcrumb mb-0 p-0"},ve=e("li",{class:"breadcrumb-item"},[e("a",{href:"javascript:;"},[e("i",{class:"bx bx-home-alt"})])],-1),be={class:"breadcrumb-item active","aria-current":"page"},ye=e("div",{class:"ms-auto"},null,-1),xe={class:"card"},Ve={class:"card-body"},we={class:"invoice overflow-auto"},Ce={class:"row"},Ue=e("h6",{class:"invoice-heading"},"INVOICE TO",-1),ke=e("hr",null,null,-1),Ae={key:0,class:"col-md-3"},$e={class:"col-md-3"},Se=["value"],Ie={class:"col-md-2"},Te={class:"col-md-2"},De={class:"d-flex align-items-center mb-1"},Ee=e("i",{class:"bx bx-edit ms-1"},null,-1),Ne={key:1,class:"col-md-2"},Pe=e("option",{value:1},"Pending",-1),Re=e("option",{value:2},"Approved",-1),qe=e("option",{value:3},"Rejected",-1),Fe=[Pe,Re,qe],Le=e("div",{class:"my-3"},null,-1),Me={class:"row"},Ke={class:"col-md-4"},Be=e("h6",{class:"invoice-heading"},"SHIPPER",-1),Oe=e("hr",null,null,-1),Ye={class:"row g-2"},Ge={class:"col-md-12"},He={for:"input13",class:"form-label"},je=e("i",{class:"bx bx-edit ms-1"},null,-1),Qe={class:"col-md-4"},We=e("h6",{class:"invoice-heading"},"CONSIGNEE",-1),Ze=e("hr",null,null,-1),ze={class:"row g-2"},Je={class:"col-md-12"},Xe={for:"input13",class:"form-label"},et=e("i",{class:"bx bx-edit ms-1"},null,-1),tt=e("div",{class:"my-3"},null,-1),st={class:"row g-2"},ot=e("h6",{class:"invoice-heading"},"SHIPMENT DETAIL",-1),lt=e("hr",null,null,-1),at={class:"col-md-3"},nt={class:"col-md-3"},rt={class:"col-md-3"},it={class:"col-md-3"},dt={class:"col-md-6"},ct={class:"col-md-1"},ut={class:"col-md-1"},mt={class:"col-md-1"},_t=e("div",{class:"my-3"},null,-1),pt=e("h6",{class:"invoice-heading"},"PARTICULARS",-1),ft={class:"col-md-6"},ht=["value"],gt=e("hr",null,null,-1),vt={style:{width:"5%"}},bt=e("i",{class:"bx bx-plus"},null,-1),yt=e("th",{class:"text-left",colspan:"3",style:{width:"45%"}},"PARTICULARS",-1),xt=e("th",{class:"text-left",style:{width:"15%"}},"UNIT PRICE",-1),Vt=e("th",{class:"text-left",style:{width:"10%"}},"QUANTITY",-1),wt=e("th",{class:"text-left",style:{width:"15%"}},"TOTAL",-1),Ct={class:"no",style:{width:"5%"}},Ut=["onClick"],kt=e("i",{class:"bx bxs-trash"},null,-1),At=[kt],$t={class:"text-left",colspan:"3",style:{width:"45%"}},St=["onUpdate:modelValue"],It={class:"text-left",style:{width:"15%"}},Tt=["onUpdate:modelValue","onKeyup"],Dt={class:"text-left",style:{width:"10%"}},Et=["onUpdate:modelValue","onKeyup"],Nt={class:"total",style:{width:"15%"}},Pt=e("td",{colspan:"4"},null,-1),Rt=e("td",{colspan:"2"},"SUBTOTAL",-1),qt=e("td",{colspan:"4"},null,-1),Ft=e("td",{colspan:"2"},"GRAND TOTAL",-1),Lt={class:"card-footer"},Mt={class:"flex items-center gap-2 mt-2"},ss={__name:"CreateInvoice",props:{invoice:Object,shippers:Array,consignees:Array,companies:Array,roles:Array,edit_mode:Boolean,page_type:String,templates:Array,carriers:Array},setup(b){const Z=D(!1),a=E().props.invoice,y=E().props.edit_mode,g=E().props.page_type;var F="",L="";const t=oe({invoice_id:a==null?void 0:a.id,invoice_at:a==null?void 0:a.invoice_at,company_id:a==null?void 0:a.company_id,shipper_id:a==null?void 0:a.shipper_id,consignee_id:a==null?void 0:a.consignee_id,carrier:a==null?void 0:a.carrier_id,mawb_no:a==null?void 0:a.mawb_no,commodity:a==null?void 0:a.commodity,quantity:a==null?void 0:a.quantity,weight:a==null?void 0:a.weight,afc_rate:a==null?void 0:a.afc_rate,departure_at:a==null?void 0:a.departure_at,landing_at:a==null?void 0:a.landing_at,sender:a==null?void 0:a.sender,destination:a==null?void 0:a.destination,subtotal:0,total:0,items:a==null?void 0:a.items,status_id:a==null?void 0:a.status_id}),z=()=>{t.items.push({particular:"",amount:"",qty:1,total:0})},J=()=>{console.log(g),g=="shipment"?y?t.post(route("shipment.update"),{preserveScroll:!0,onSuccess:()=>C(),onError:()=>w(),onFinish:()=>{}}):t.post(route("shipment.store"),{preserveScroll:!0,onSuccess:()=>C(),onError:()=>w(),onFinish:()=>{}}):g=="invoice"?t.post(route("invoice.update"),{preserveScroll:!0,onSuccess:()=>C(),onError:()=>w(),onFinish:()=>{}}):t.post(route("invoice.store"),{preserveScroll:!0,onSuccess:()=>C(),onError:()=>w(),onFinish:()=>{}})},w=()=>{},C=()=>{Z.value=!1,t.reset()},X=r=>{t.items.splice(r,1),$()},$=()=>{t.subtotal=0,t.items.forEach(r=>{t.subtotal+=parseFloat(r.total)}),t.total=t.subtotal},M=r=>{const o=t.items[r],l=o.qty*o.amount;o.total=l,$()},K=r=>{r&&k.get(`/users/fetch/shipper/${r}`).then(({data:o})=>{F=o.selected_shipper})},B=r=>{r&&k.get(`/users/fetch/consignee/${r}`).then(({data:o})=>{L=o.selected_consignee})},S=D(null),O=r=>{S.value.edit(r)},I=r=>new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(r),T=r=>de(r).format("YYYY-MM-DD HH:mm");le(()=>{t.departure_at&&(t.departure_at=T(t.departure_at)),t.landing_at&&(t.landing_at=T(t.landing_at)),t.invoice_at&&(t.invoice_at=T(t.invoice_at))}),ae(()=>{y||(t.items=[{particular:"",amount:0,qty:1,total:0}]),y&&$(),K(t.shipper_id),B(t.consignee_id)});const ee=r=>{k.get(`/templates/fetch/particulars/${r}`).then(({data:o})=>{t.items=o.particulars})};var Y="";const te=r=>{r&&k.get(`/carriers/fetch/carrier/${r}`).then(({data:o})=>{Y=o.selected_carrier})},G=D(null),se=r=>{console.log(r),G.value.editCarrier(r)};return(r,o)=>(u(),m(x,null,[n(s(ne),{title:"Invoices"}),n(ie,null,{default:f(()=>[e("div",ue,[e("div",me,[e("div",_e,[pe,e("div",fe,[e("nav",he,[e("ol",ge,[ve,e("li",be,h(s(y)?"Create":"Edit"),1)])])]),ye]),e("div",xe,[e("form",{onSubmit:o[25]||(o[25]=re(l=>J(),["prevent"]))},[e("div",Ve,[e("div",we,[e("div",Ce,[Ue,ke,s(g)=="invoice"?(u(),m("div",Ae,[n(d,{for:"",value:"Invoice Date",class:"mb-1"}),n(s(R),{modelValue:s(t).invoice_at,"onUpdate:modelValue":o[0]||(o[0]=l=>s(t).invoice_at=l),teleport:!0},null,8,["modelValue"]),n(i,{message:s(t).errors.invoice_at},null,8,["message"])])):V("",!0),e("div",$e,[n(d,{for:"",value:"Company Account",class:"mb-1"}),c(e("select",{class:"form-control","onUpdate:modelValue":o[1]||(o[1]=l=>s(t).company_id=l),onChange:o[2]||(o[2]=l=>r.fetchAddress("company"))},[(u(!0),m(x,null,P(b.companies,l=>(u(),m("option",{key:l.id,value:l.id},h(l.id)+" - "+h(l.name),9,Se))),128))],544),[[N,s(t).company_id]]),n(i,{message:s(t).errors.company_id},null,8,["message"])]),e("div",Ie,[n(d,{for:"",value:"MAWB No",class:"mb-1"}),c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":o[3]||(o[3]=l=>s(t).mawb_no=l)},null,512),[[_,s(t).mawb_no]]),n(i,{message:s(t).errors.mawb_no},null,8,["message"])]),e("div",Te,[e("div",De,[n(d,{for:"",value:"Carrier",class:"me-2"}),n(ce,{ref_key:"create_edit_carrier_ref",ref:G},null,512),n(A,{onClick:o[4]||(o[4]=l=>se(s(Y))),type:"button"},{default:f(()=>[p("Edit"),Ee]),_:1})]),n(s(q),{style:{"margin-top":"3px !important"},searchable:!0,modelValue:s(t).carrier,"onUpdate:modelValue":o[5]||(o[5]=l=>s(t).carrier=l),options:b.carriers,onClick:o[6]||(o[6]=l=>te(s(t).carrier))},null,8,["modelValue","options"]),n(i,{message:s(t).errors.carrier},null,8,["message"])]),s(g)=="invoice"?(u(),m("div",Ne,[n(d,{for:"",value:"Invoice Status",class:"mb-1"}),c(e("select",{class:"form-control","onUpdate:modelValue":o[7]||(o[7]=l=>s(t).status_id=l)},Fe,512),[[N,s(t).status_id]]),n(i,{message:s(t).errors.status_id},null,8,["message"])])):V("",!0)]),Le,e("div",Me,[e("div",Ke,[Be,Oe,e("div",Ye,[e("div",Ge,[e("label",He,[p("Account Number "),n(W,{roles:b.roles,selected_role:3,ref_key:"create_edit_ref",ref:S},null,8,["roles"]),n(A,{onClick:o[8]||(o[8]=l=>O(s(F))),type:"button"},{default:f(()=>[p("Edit "),je]),_:1})]),n(s(q),{style:{"margin-top":"3px !important"},searchable:!0,modelValue:s(t).shipper_id,"onUpdate:modelValue":o[9]||(o[9]=l=>s(t).shipper_id=l),options:b.shippers,onClick:o[10]||(o[10]=l=>K(s(t).shipper_id))},null,8,["modelValue","options"]),n(i,{message:s(t).errors.shipper_id},null,8,["message"])])])]),e("div",Qe,[We,Ze,e("div",ze,[e("div",Je,[e("label",Xe,[p("Account Number "),n(W,{roles:b.roles,selected_role:4,ref_key:"create_edit_ref",ref:S},null,8,["roles"]),n(A,{onClick:o[11]||(o[11]=l=>O(s(L))),type:"button"},{default:f(()=>[p("Edit "),et]),_:1})]),n(s(q),{style:{"margin-top":"3px !important"},searchable:!0,modelValue:s(t).consignee_id,"onUpdate:modelValue":o[12]||(o[12]=l=>s(t).consignee_id=l),options:b.consignees,onClick:o[13]||(o[13]=l=>B(s(t).consignee_id))},null,8,["modelValue","options"]),n(i,{message:s(t).errors.consignee_id},null,8,["message"])])])])]),tt,e("div",st,[ot,lt,e("div",at,[n(d,{for:"",value:"Departure Date",class:"mb-1"}),n(s(R),{modelValue:s(t).departure_at,"onUpdate:modelValue":o[14]||(o[14]=l=>s(t).departure_at=l),teleport:!0,"is-24":!1},null,8,["modelValue"]),n(i,{message:s(t).errors.departure_at},null,8,["message"])]),e("div",nt,[n(d,{for:"",value:"Landing Date",class:"mb-1"}),n(s(R),{modelValue:s(t).landing_at,"onUpdate:modelValue":o[15]||(o[15]=l=>s(t).landing_at=l),teleport:!0,"is-24":!1},null,8,["modelValue"]),n(i,{message:s(t).errors.landing_at},null,8,["message"])]),e("div",rt,[n(d,{for:"",value:"Port of Departure",class:"mb-1"}),c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":o[16]||(o[16]=l=>s(t).sender=l)},null,512),[[_,s(t).sender]]),n(i,{message:s(t).errors.sender},null,8,["message"])]),e("div",it,[n(d,{for:"",value:"Port of Landing",class:"mb-1"}),c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":o[17]||(o[17]=l=>s(t).destination=l)},null,512),[[_,s(t).destination]]),n(i,{message:s(t).errors.destination},null,8,["message"])]),e("div",dt,[n(d,{for:"",value:"Commodity",class:"mb-1"}),c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":o[18]||(o[18]=l=>s(t).commodity=l)},null,512),[[_,s(t).commodity]]),n(i,{message:s(t).errors.commodity},null,8,["message"])]),e("div",ct,[n(d,{for:"",value:"Quantity",class:"mb-1"}),c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":o[19]||(o[19]=l=>s(t).quantity=l)},null,512),[[_,s(t).quantity]]),n(i,{message:s(t).errors.quantity},null,8,["message"])]),e("div",ut,[n(d,{for:"",value:"Weight",class:"mb-1"}),c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":o[20]||(o[20]=l=>s(t).weight=l)},null,512),[[_,s(t).weight]]),n(i,{message:s(t).errors.weight},null,8,["message"])]),e("div",mt,[n(d,{for:"",value:"AFC Rate/KG",class:"mb-1"}),c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":o[21]||(o[21]=l=>s(t).afc_rate=l)},null,512),[[_,s(t).afc_rate]]),n(i,{message:s(t).errors.afc_rate},null,8,["message"])])]),s(g)=="invoice"?(u(),m(x,{key:0},[_t,pt,e("div",ft,[n(d,{for:"",value:"Templates",class:"mb-1"}),c(e("select",{class:"form-control","onUpdate:modelValue":o[22]||(o[22]=l=>s(t).template_id=l),onChange:o[23]||(o[23]=l=>ee(s(t).template_id))},[(u(!0),m(x,null,P(b.templates,l=>(u(),m("option",{key:l.id,value:l.id},h(l.title),9,ht))),128))],544),[[N,s(t).template_id]])]),gt,e("table",null,[e("thead",null,[e("tr",null,[e("th",vt,[e("button",{type:"button",onClick:o[24]||(o[24]=l=>z()),class:"ms-1 text-sucess btn btn-success btn-sm"},[bt,p("Add Item")])]),yt,xt,Vt,wt])]),e("tbody",null,[(u(!0),m(x,null,P(s(t).items,(l,U)=>(u(),m("tr",{key:l.id},[e("td",Ct,[e("span",null,[p(" Item #"+h(U)+" ",1),e("button",{type:"button",onClick:v=>X(U),class:"ms-1 text-danger"},At,8,Ut)])]),e("td",$t,[c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":v=>l.particular=v},null,8,St),[[_,l.particular]])]),e("td",It,[c(e("input",{type:"number",class:"form-control","onUpdate:modelValue":v=>l.amount=v,onKeyup:v=>M(U)},null,40,Tt),[[_,l.amount]])]),e("td",Dt,[c(e("input",{type:"number",class:"form-control","onUpdate:modelValue":v=>l.qty=v,onKeyup:v=>M(U)},null,40,Et),[[_,l.qty]])]),e("td",Nt,"PKR "+h(I(l.total)),1)]))),128))]),e("tfoot",null,[e("tr",null,[Pt,Rt,e("td",null,"PKR "+h(I(s(t).subtotal)),1)]),e("tr",null,[qt,Ft,e("td",null,"PKR "+h(I(s(t).total)),1)])])])],64)):V("",!0)])]),e("div",Lt,[e("div",Mt,[n(A,{disabled:s(t).processing},{default:f(()=>[p(h(s(y)?"Update":"Save"),1)]),_:1},8,["disabled"]),s(g)=="shipment"?(u(),H(s(j),{key:0,href:r.route("shipment.index")},{default:f(()=>[n(Q,{disabled:s(t).processing},{default:f(()=>[p(" Cancel ")]),_:1},8,["disabled"])]),_:1},8,["href"])):V("",!0),s(g)=="invoice"?(u(),H(s(j),{key:1,href:r.route("invoice.index")},{default:f(()=>[n(Q,{disabled:s(t).processing},{default:f(()=>[p(" Cancel ")]),_:1},8,["disabled"])]),_:1},8,["href"])):V("",!0)])])],32)])])])]),_:1})],64))}};export{ss as default};
