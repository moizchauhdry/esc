import{m as K,J as T,v as J,s as X,f as _,a,u as s,w as g,F as v,x as M,o as c,X as Y,b as e,t as u,e as z,g as C,i as d,p as $,y as S,q as p,d as h,c as B,l as O}from"./app-09fffad0.js";import{_ as ee}from"./AuthenticatedLayout-d6579d73.js";import{_ as i}from"./InputError-d748b871.js";import{_ as E}from"./PrimaryButton-5fa8a241.js";import{_ as G}from"./DangerButton-67adb38c.js";import j from"./CreateEdit-05ce451c.js";import{Z as N}from"./main-57b6ed41.js";import{_ as m}from"./InputLabel-3fd5c53a.js";import"./SecondaryButton-48ff1f52.js";import"./SuccessButton-7e8fa855.js";const te={class:"page-wrapper"},se={class:"page-content"},oe={class:"page-breadcrumb d-none d-sm-flex align-items-center mb-3"},le=e("div",{class:"breadcrumb-title pe-3"},"Manage Shipments",-1),ne={class:"ps-3"},ae={"aria-label":"breadcrumb"},re={class:"breadcrumb mb-0 p-0"},de=e("li",{class:"breadcrumb-item"},[e("a",{href:"javascript:;"},[e("i",{class:"bx bx-home-alt"})])],-1),ie={class:"breadcrumb-item active","aria-current":"page"},ce=e("div",{class:"ms-auto"},null,-1),ue={class:"card"},me={class:"card-body"},_e={class:"invoice overflow-auto"},pe={class:"row"},he=e("h6",{class:"invoice-heading"},"INVOICE TO",-1),fe=e("hr",null,null,-1),ge={key:0,class:"col-md-2"},be={class:"col-md-4"},ve=["value"],ye={class:"col-md-2"},xe={class:"col-md-2"},we=e("div",{class:"my-3"},null,-1),Ve={class:"row"},Ue={class:"col-md-4"},Ce=e("h6",{class:"invoice-heading"},"SHIPPER",-1),Se=e("hr",null,null,-1),Ae={class:"row g-2"},Ie={class:"col-md-12"},ke={for:"input13",class:"form-label"},Te=e("i",{class:"bx bx-edit ms-1"},null,-1),$e=["value"],Ee={class:"col-md-4"},Ne=e("h6",{class:"invoice-heading"},"CONSIGNEE",-1),qe=e("hr",null,null,-1),De={class:"row g-2"},Fe={class:"col-md-12"},Pe={for:"input13",class:"form-label"},Re=e("i",{class:"bx bx-edit ms-1"},null,-1),Le=["value"],Ke=e("div",{class:"my-3"},null,-1),Me={class:"row g-2"},Be=e("h6",{class:"invoice-heading"},"SHIPMENT DETAIL",-1),Oe=e("hr",null,null,-1),Ge={class:"col-md-3"},je={class:"col-md-3"},He={class:"col-md-3"},Qe={class:"col-md-3"},We={class:"col-md-6"},Ze={class:"col-md-1"},Je={class:"col-md-1"},Xe={class:"col-md-1"},Ye=e("div",{class:"my-3"},null,-1),ze=e("h6",{class:"invoice-heading"},"PARTICULARS",-1),et=e("hr",null,null,-1),tt={style:{width:"5%"}},st=e("i",{class:"bx bx-plus"},null,-1),ot=e("th",{class:"text-left",colspan:"3",style:{width:"45%"}},"PARTICULARS",-1),lt=e("th",{class:"text-left",style:{width:"15%"}},"UNIT PRICE",-1),nt=e("th",{class:"text-left",style:{width:"10%"}},"QUANTITY",-1),at=e("th",{class:"text-left",style:{width:"15%"}},"TOTAL",-1),rt={class:"no",style:{width:"5%"}},dt=["onClick"],it=e("i",{class:"bx bxs-trash"},null,-1),ct=[it],ut={class:"text-left",colspan:"3",style:{width:"45%"}},mt=["onUpdate:modelValue"],_t={class:"text-left",style:{width:"15%"}},pt=["onUpdate:modelValue","onKeyup"],ht={class:"text-left",style:{width:"10%"}},ft=["onUpdate:modelValue","onKeyup"],gt={class:"total",style:{width:"15%"}},bt=e("td",{colspan:"4"},null,-1),vt=e("td",{colspan:"2"},"SUBTOTAL",-1),yt=e("td",{colspan:"4"},null,-1),xt=e("td",{colspan:"2"},"GRAND TOTAL",-1),wt={class:"card-footer"},Vt={class:"flex items-center gap-2 mt-2"},qt={__name:"CreateInvoice",props:{invoice:Object,shippers:Array,consignees:Array,companies:Array,roles:Array,edit_mode:Boolean,page_type:String},setup(y){const H=K(!1),n=T().props.invoice,x=T().props.edit_mode,b=T().props.page_type;var q="",D="";const t=J({invoice_id:n==null?void 0:n.id,invoice_at:n==null?void 0:n.invoice_at,company_id:n==null?void 0:n.company_id,shipper_id:n==null?void 0:n.shipper_id,consignee_id:n==null?void 0:n.consignee_id,carrier:n==null?void 0:n.carrier,mawb_no:n==null?void 0:n.mawb_no,commodity:n==null?void 0:n.commodity,quantity:n==null?void 0:n.quantity,weight:n==null?void 0:n.weight,afc_rate:n==null?void 0:n.afc_rate,departure_at:n==null?void 0:n.departure_at,landing_at:n==null?void 0:n.landing_at,sender:n==null?void 0:n.sender,destination:n==null?void 0:n.destination,subtotal:0,total:0,items:n==null?void 0:n.items}),Q=()=>{t.items.push({particular:"",amount:"",qty:1,total:0})},W=()=>{console.log(b),b=="shipment"?x?t.post(route("shipment.update"),{preserveScroll:!0,onSuccess:()=>V(),onError:()=>w(),onFinish:()=>{}}):t.post(route("shipment.store"),{preserveScroll:!0,onSuccess:()=>V(),onError:()=>w(),onFinish:()=>{}}):b=="invoice"?t.post(route("invoice.update"),{preserveScroll:!0,onSuccess:()=>V(),onError:()=>w(),onFinish:()=>{}}):t.post(route("invoice.store"),{preserveScroll:!0,onSuccess:()=>V(),onError:()=>w(),onFinish:()=>{}})},w=()=>{},V=()=>{H.value=!1,t.reset()},Z=r=>{t.items.splice(r,1),A()},A=()=>{t.subtotal=0,t.items.forEach(r=>{t.subtotal+=parseFloat(r.total)}),t.total=t.subtotal},F=r=>{const l=t.items[r],o=l.qty*l.amount;l.total=o,A()},P=r=>{M.get(`/users/fetch/shipper/${r}`).then(({data:l})=>{q=l.selected_shipper})},R=r=>{M.get(`/users/fetch/consignee/${r}`).then(({data:l})=>{D=l.selected_consignee})},I=K(null),L=r=>{I.value.edit(r)},k=r=>new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(r);return X(()=>{x||(t.items=[{particular:"",amount:0,qty:1,total:0}]),x&&A(),P(t.shipper_id),R(t.consignee_id)}),(r,l)=>(c(),_(v,null,[a(s(Y),{title:"Invoices"}),a(ee,null,{default:g(()=>[e("div",te,[e("div",se,[e("div",oe,[le,e("div",ne,[e("nav",ae,[e("ol",re,[de,e("li",ie,u(s(x)?"Create":"Edit"),1)])])]),ce]),e("div",ue,[e("form",{onSubmit:l[20]||(l[20]=z(o=>W(),["prevent"]))},[e("div",me,[e("div",_e,[e("div",pe,[he,fe,s(b)=="invoice"?(c(),_("div",ge,[a(m,{for:"",value:"Invoice Date",class:"mb-1"}),a(s(N),{modelValue:s(t).invoice_at,"onUpdate:modelValue":l[0]||(l[0]=o=>s(t).invoice_at=o),teleport:!0,"enable-time-picker":!1},null,8,["modelValue"]),a(i,{message:s(t).errors.invoice_at},null,8,["message"])])):C("",!0),e("div",be,[a(m,{for:"",value:"Company Account",class:"mb-1"}),d(e("select",{class:"form-control","onUpdate:modelValue":l[1]||(l[1]=o=>s(t).company_id=o),onChange:l[2]||(l[2]=o=>r.fetchAddress("company"))},[(c(!0),_(v,null,S(y.companies,o=>(c(),_("option",{key:o.id,value:o.id},u(o.id)+" - "+u(o.name),9,ve))),128))],544),[[$,s(t).company_id]]),a(i,{message:s(t).errors.company_id},null,8,["message"])]),e("div",ye,[a(m,{for:"",value:"MAWB No",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[3]||(l[3]=o=>s(t).mawb_no=o)},null,512),[[p,s(t).mawb_no]]),a(i,{message:s(t).errors.mawb_no},null,8,["message"])]),e("div",xe,[a(m,{for:"",value:"Carrier",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[4]||(l[4]=o=>s(t).carrier=o)},null,512),[[p,s(t).carrier]]),a(i,{message:s(t).errors.carrier},null,8,["message"])])]),we,e("div",Ve,[e("div",Ue,[Ce,Se,e("div",Ae,[e("div",Ie,[e("label",ke,[h("Account Number "),a(j,{roles:y.roles,selected_role:3,ref_key:"create_edit_ref",ref:I},null,8,["roles"]),a(E,{onClick:l[5]||(l[5]=o=>L(s(q))),type:"button"},{default:g(()=>[h("Edit "),Te]),_:1})]),d(e("select",{class:"form-control","onUpdate:modelValue":l[6]||(l[6]=o=>s(t).shipper_id=o),onChange:l[7]||(l[7]=o=>P(s(t).shipper_id))},[(c(!0),_(v,null,S(y.shippers,o=>(c(),_("option",{key:o.id,value:o.id},u(o.id)+" - "+u(o.name),9,$e))),128))],544),[[$,s(t).shipper_id]]),a(i,{message:s(t).errors.shipper_id},null,8,["message"])])])]),e("div",Ee,[Ne,qe,e("div",De,[e("div",Fe,[e("label",Pe,[h("Account Number "),a(j,{roles:y.roles,selected_role:4,ref_key:"create_edit_ref",ref:I},null,8,["roles"]),a(E,{onClick:l[8]||(l[8]=o=>L(s(D))),type:"button"},{default:g(()=>[h("Edit "),Re]),_:1})]),d(e("select",{class:"form-control","onUpdate:modelValue":l[9]||(l[9]=o=>s(t).consignee_id=o),onChange:l[10]||(l[10]=o=>R(s(t).consignee_id))},[(c(!0),_(v,null,S(y.consignees,o=>(c(),_("option",{key:o.id,value:o.id},u(o.id)+" - "+u(o.name),9,Le))),128))],544),[[$,s(t).consignee_id]]),a(i,{message:s(t).errors.consignee_id},null,8,["message"])])])])]),Ke,e("div",Me,[Be,Oe,e("div",Ge,[a(m,{for:"",value:"Departure Date",class:"mb-1"}),a(s(N),{modelValue:s(t).departure_at,"onUpdate:modelValue":l[11]||(l[11]=o=>s(t).departure_at=o),teleport:!0},null,8,["modelValue"]),a(i,{message:s(t).errors.departure_at},null,8,["message"])]),e("div",je,[a(m,{for:"",value:"Landing Date",class:"mb-1"}),a(s(N),{modelValue:s(t).landing_at,"onUpdate:modelValue":l[12]||(l[12]=o=>s(t).landing_at=o),teleport:!0},null,8,["modelValue"]),a(i,{message:s(t).errors.landing_at},null,8,["message"])]),e("div",He,[a(m,{for:"",value:"Port of Departure",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[13]||(l[13]=o=>s(t).sender=o)},null,512),[[p,s(t).sender]]),a(i,{message:s(t).errors.sender},null,8,["message"])]),e("div",Qe,[a(m,{for:"",value:"Port of Landing",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[14]||(l[14]=o=>s(t).destination=o)},null,512),[[p,s(t).destination]]),a(i,{message:s(t).errors.destination},null,8,["message"])]),e("div",We,[a(m,{for:"",value:"Commodity",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[15]||(l[15]=o=>s(t).commodity=o)},null,512),[[p,s(t).commodity]]),a(i,{message:s(t).errors.commodity},null,8,["message"])]),e("div",Ze,[a(m,{for:"",value:"Quantity",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[16]||(l[16]=o=>s(t).quantity=o)},null,512),[[p,s(t).quantity]]),a(i,{message:s(t).errors.quantity},null,8,["message"])]),e("div",Je,[a(m,{for:"",value:"Weight",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[17]||(l[17]=o=>s(t).weight=o)},null,512),[[p,s(t).weight]]),a(i,{message:s(t).errors.weight},null,8,["message"])]),e("div",Xe,[a(m,{for:"",value:"AFC Rate/KG",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[18]||(l[18]=o=>s(t).afc_rate=o)},null,512),[[p,s(t).afc_rate]]),a(i,{message:s(t).errors.afc_rate},null,8,["message"])])]),s(b)=="invoice"?(c(),_(v,{key:0},[Ye,ze,et,e("table",null,[e("thead",null,[e("tr",null,[e("th",tt,[e("button",{type:"button",onClick:l[19]||(l[19]=o=>Q()),class:"ms-1 text-sucess btn btn-success btn-sm"},[st,h("Add Item")])]),ot,lt,nt,at])]),e("tbody",null,[(c(!0),_(v,null,S(s(t).items,(o,U)=>(c(),_("tr",{key:o.id},[e("td",rt,[e("span",null,[h(" Item #"+u(U)+" ",1),e("button",{type:"button",onClick:f=>Z(U),class:"ms-1 text-danger"},ct,8,dt)])]),e("td",ut,[d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":f=>o.particular=f},null,8,mt),[[p,o.particular]])]),e("td",_t,[d(e("input",{type:"number",class:"form-control","onUpdate:modelValue":f=>o.amount=f,onKeyup:f=>F(U)},null,40,pt),[[p,o.amount]])]),e("td",ht,[d(e("input",{type:"number",class:"form-control","onUpdate:modelValue":f=>o.qty=f,onKeyup:f=>F(U)},null,40,ft),[[p,o.qty]])]),e("td",gt,"PKR "+u(k(o.total)),1)]))),128))]),e("tfoot",null,[e("tr",null,[bt,vt,e("td",null,"PKR "+u(k(s(t).subtotal)),1)]),e("tr",null,[yt,xt,e("td",null,"PKR "+u(k(s(t).total)),1)])])])],64)):C("",!0)])]),e("div",wt,[e("div",Vt,[a(E,{disabled:s(t).processing},{default:g(()=>[h(u(s(x)?"Update":"Save"),1)]),_:1},8,["disabled"]),s(b)=="shipment"?(c(),B(s(O),{key:0,href:r.route("shipment.index")},{default:g(()=>[a(G,{disabled:s(t).processing},{default:g(()=>[h(" Cancel ")]),_:1},8,["disabled"])]),_:1},8,["href"])):C("",!0),s(b)=="invoice"?(c(),B(s(O),{key:1,href:r.route("invoice.index")},{default:g(()=>[a(G,{disabled:s(t).processing},{default:g(()=>[h(" Cancel ")]),_:1},8,["disabled"])]),_:1},8,["href"])):C("",!0)])])],32)])])])]),_:1})],64))}};export{qt as default};
