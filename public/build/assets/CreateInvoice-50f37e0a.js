import{p as E,J as D,v as oe,B as le,m as ae,f as m,a as n,u as s,w as p,F as V,C as A,o as u,X as ne,b as e,t as h,e as re,g as x,i as d,A as N,y as R,z as _,d as v,c as H,l as j}from"./app-f41c96d7.js";import{_ as ie}from"./AuthenticatedLayout-b06736b0.js";import{_ as i}from"./InputError-3b9c20d3.js";import{_ as k}from"./PrimaryButton-9c42ee46.js";import{_ as Q}from"./DangerButton-5afa483e.js";import W from"./CreateEdit-63e360c4.js";import{Z as P}from"./main-91028291.js";import{_ as c}from"./InputLabel-242cf4c4.js";import{h as de}from"./moment-a9aaa855.js";import{s as F}from"./multiselect-dc6678a2.js";import ce from"./CreateCarrier-2c7cd939.js";/* empty css                                                         */import"./index-bc8fed15.js";import"./SecondaryButton-ca0c5d7b.js";import"./SuccessButton-41470eda.js";const ue={class:"page-wrapper"},me={class:"page-content"},_e={class:"page-breadcrumb d-none d-sm-flex align-items-center mb-3"},pe=e("div",{class:"breadcrumb-title pe-3"},"Manage Shipments",-1),he={class:"ps-3"},fe={"aria-label":"breadcrumb"},ge={class:"breadcrumb mb-0 p-0"},ve=e("li",{class:"breadcrumb-item"},[e("a",{href:"javascript:;"},[e("i",{class:"bx bx-home-alt"})])],-1),be={class:"breadcrumb-item active","aria-current":"page"},ye=e("div",{class:"ms-auto"},null,-1),Ve={class:"card"},xe={class:"card-body"},Ce={class:"invoice overflow-auto"},we={class:"row"},Ue=e("h6",{class:"invoice-heading"},"INVOICE TO",-1),Ae=e("hr",null,null,-1),ke={key:0,class:"col-md-3"},Te={key:1,class:"col-md-3"},$e=e("option",{value:1},"Pending",-1),Se=e("option",{value:2},"Approved",-1),Ie=e("option",{value:3},"Rejected",-1),Ee=[$e,Se,Ie],De={class:"col-md-3"},Ne=["value"],Re={class:"col-md-3"},Pe=e("div",{class:"my-3"},null,-1),Fe={class:"row"},qe={class:"col-md-4"},Le=e("h6",{class:"invoice-heading"},"SHIPPER ACCOUNT",-1),Me=e("hr",null,null,-1),Oe={class:"row mb-3"},Be={class:"col-md-12"},Ke=e("i",{class:"bx bx-edit ms-1"},null,-1),Ye={class:"col-md-4"},Ge=e("h6",{class:"invoice-heading"},"CONSIGNEE ACCOUNT",-1),He=e("hr",null,null,-1),je={class:"row mb-3"},Qe={class:"col-md-12"},We=e("i",{class:"bx bx-edit ms-1"},null,-1),Ze={class:"col-md-4"},ze=e("h6",{class:"invoice-heading"},"CARRIER",-1),Je=e("hr",null,null,-1),Xe={class:"row mb-3"},et={class:"col-md-12"},tt=e("i",{class:"bx bx-edit ms-1"},null,-1),st=e("div",{class:"my-3"},null,-1),ot={class:"row g-2"},lt=e("h6",{class:"invoice-heading"},"SHIPMENT DETAIL",-1),at=e("hr",null,null,-1),nt={class:"col-md-3"},rt={class:"col-md-3"},it={class:"col-md-3"},dt={class:"col-md-3"},ct={class:"col-md-6"},ut={class:"col-md-1"},mt={class:"col-md-1"},_t={class:"col-md-1"},pt=e("div",{class:"my-3"},null,-1),ht=e("h6",{class:"invoice-heading"},"PARTICULARS",-1),ft={class:"col-md-6"},gt=["value"],vt=e("hr",null,null,-1),bt={style:{width:"5%"}},yt=e("i",{class:"bx bx-plus"},null,-1),Vt=e("th",{class:"text-left",colspan:"3",style:{width:"45%"}},"PARTICULARS",-1),xt=e("th",{class:"text-left",style:{width:"15%"}},"UNIT PRICE",-1),Ct=e("th",{class:"text-left",style:{width:"10%"}},"QUANTITY",-1),wt=e("th",{class:"text-left",style:{width:"15%"}},"TOTAL",-1),Ut={class:"no",style:{width:"5%"}},At=["onClick"],kt=e("i",{class:"bx bxs-trash"},null,-1),Tt=[kt],$t={class:"text-left",colspan:"3",style:{width:"45%"}},St=["onUpdate:modelValue"],It={class:"text-left",style:{width:"15%"}},Et=["onUpdate:modelValue","onKeyup"],Dt={class:"text-left",style:{width:"10%"}},Nt=["onUpdate:modelValue","onKeyup"],Rt={class:"total",style:{width:"15%"}},Pt=e("td",{colspan:"4"},null,-1),Ft=e("td",{colspan:"2"},"SUBTOTAL",-1),qt=e("td",{colspan:"4"},null,-1),Lt=e("td",{colspan:"2"},"GRAND TOTAL",-1),Mt={class:"card-footer"},Ot={class:"flex items-center gap-2 mt-2"},os={__name:"CreateInvoice",props:{invoice:Object,shippers:Array,consignees:Array,companies:Array,roles:Array,edit_mode:Boolean,page_type:String,templates:Array,carriers:Array},setup(b){const Z=E(!1),a=D().props.invoice,y=D().props.edit_mode,f=D().props.page_type;var q="",L="";const t=oe({invoice_id:a==null?void 0:a.id,invoice_at:a==null?void 0:a.invoice_at,company_id:a==null?void 0:a.company_id,shipper_id:a==null?void 0:a.shipper_id,consignee_id:a==null?void 0:a.consignee_id,carrier:a==null?void 0:a.carrier_id,mawb_no:a==null?void 0:a.mawb_no,commodity:a==null?void 0:a.commodity,quantity:a==null?void 0:a.quantity,weight:a==null?void 0:a.weight,afc_rate:a==null?void 0:a.afc_rate,departure_at:a==null?void 0:a.departure_at,landing_at:a==null?void 0:a.landing_at,sender:a==null?void 0:a.sender,destination:a==null?void 0:a.destination,subtotal:0,total:0,items:a==null?void 0:a.items,status_id:a==null?void 0:a.status_id}),z=()=>{t.items.push({particular:"",amount:"",qty:1,total:0})},J=()=>{console.log(f),f=="shipment"?y?t.post(route("shipment.update"),{preserveScroll:!0,onSuccess:()=>w(),onError:()=>C(),onFinish:()=>{}}):t.post(route("shipment.store"),{preserveScroll:!0,onSuccess:()=>w(),onError:()=>C(),onFinish:()=>{}}):f=="invoice"?t.post(route("invoice.update"),{preserveScroll:!0,onSuccess:()=>w(),onError:()=>C(),onFinish:()=>{}}):t.post(route("invoice.store"),{preserveScroll:!0,onSuccess:()=>w(),onError:()=>C(),onFinish:()=>{}})},C=()=>{},w=()=>{Z.value=!1,t.reset()},X=r=>{t.items.splice(r,1),T()},T=()=>{t.subtotal=0,t.items.forEach(r=>{t.subtotal+=parseFloat(r.total)}),t.total=t.subtotal},M=r=>{const o=t.items[r],l=o.qty*o.amount;o.total=l,T()},O=r=>{r&&A.get(`/users/fetch/shipper/${r}`).then(({data:o})=>{q=o.selected_shipper})},B=r=>{r&&A.get(`/users/fetch/consignee/${r}`).then(({data:o})=>{L=o.selected_consignee})},$=E(null),K=r=>{$.value.edit(r)},S=r=>new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(r),I=r=>de(r).format("YYYY-MM-DD HH:mm");le(()=>{t.departure_at&&(t.departure_at=I(t.departure_at)),t.landing_at&&(t.landing_at=I(t.landing_at)),t.invoice_at&&(t.invoice_at=I(t.invoice_at))}),ae(()=>{y||(t.items=[{particular:"",amount:0,qty:1,total:0}]),y&&T(),O(t.shipper_id),B(t.consignee_id)});const ee=r=>{A.get(`/templates/fetch/particulars/${r}`).then(({data:o})=>{t.items=o.particulars})};var Y="";const te=r=>{r&&A.get(`/carriers/fetch/carrier/${r}`).then(({data:o})=>{Y=o.selected_carrier})},G=E(null),se=r=>{console.log(r),G.value.editCarrier(r)};return(r,o)=>(u(),m(V,null,[n(s(ne),{title:"Invoices"}),n(ie,null,{default:p(()=>[e("div",ue,[e("div",me,[e("div",_e,[pe,e("div",he,[e("nav",fe,[e("ol",ge,[ve,e("li",be,h(s(y)?"Create":"Edit"),1)])])]),ye]),e("div",Ve,[e("form",{onSubmit:o[25]||(o[25]=re(l=>J(),["prevent"]))},[e("div",xe,[e("div",Ce,[e("div",we,[Ue,Ae,s(f)=="invoice"?(u(),m("div",ke,[n(c,{for:"",value:"Invoice Date",class:"mb-1"}),n(s(P),{modelValue:s(t).invoice_at,"onUpdate:modelValue":o[0]||(o[0]=l=>s(t).invoice_at=l),teleport:!0,"enable-time-picker":!1},null,8,["modelValue"]),n(i,{message:s(t).errors.invoice_at},null,8,["message"])])):x("",!0),s(f)=="invoice"?(u(),m("div",Te,[n(c,{for:"",value:"Invoice Status",class:"mb-1"}),d(e("select",{class:"form-control","onUpdate:modelValue":o[1]||(o[1]=l=>s(t).status_id=l)},Ee,512),[[N,s(t).status_id]]),n(i,{message:s(t).errors.status_id},null,8,["message"])])):x("",!0),e("div",De,[n(c,{for:"",value:"Company Account",class:"mb-1"}),d(e("select",{class:"form-control","onUpdate:modelValue":o[2]||(o[2]=l=>s(t).company_id=l),onChange:o[3]||(o[3]=l=>r.fetchAddress("company"))},[(u(!0),m(V,null,R(b.companies,l=>(u(),m("option",{key:l.id,value:l.id},h(l.id)+" - "+h(l.name),9,Ne))),128))],544),[[N,s(t).company_id]]),n(i,{message:s(t).errors.company_id},null,8,["message"])]),e("div",Re,[n(c,{for:"",value:"MAWB No",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":o[4]||(o[4]=l=>s(t).mawb_no=l)},null,512),[[_,s(t).mawb_no]]),n(i,{message:s(t).errors.mawb_no},null,8,["message"])])]),Pe,e("div",Fe,[e("div",qe,[Le,Me,e("div",Oe,[e("div",Be,[n(W,{roles:b.roles,selected_role:3,ref_key:"create_edit_ref",ref:$},null,8,["roles"]),n(k,{onClick:o[5]||(o[5]=l=>K(s(q))),type:"button"},{default:p(()=>[v("Edit "),Ke]),_:1}),n(s(F),{style:{"margin-top":"3px !important"},searchable:!0,modelValue:s(t).shipper_id,"onUpdate:modelValue":o[6]||(o[6]=l=>s(t).shipper_id=l),options:b.shippers,onClick:o[7]||(o[7]=l=>O(s(t).shipper_id))},null,8,["modelValue","options"]),n(i,{message:s(t).errors.shipper_id},null,8,["message"])])])]),e("div",Ye,[Ge,He,e("div",je,[e("div",Qe,[n(W,{roles:b.roles,selected_role:4,ref_key:"create_edit_ref",ref:$},null,8,["roles"]),n(k,{onClick:o[8]||(o[8]=l=>K(s(L))),type:"button"},{default:p(()=>[v("Edit "),We]),_:1}),n(s(F),{style:{"margin-top":"3px !important"},searchable:!0,modelValue:s(t).consignee_id,"onUpdate:modelValue":o[9]||(o[9]=l=>s(t).consignee_id=l),options:b.consignees,onClick:o[10]||(o[10]=l=>B(s(t).consignee_id))},null,8,["modelValue","options"]),n(i,{message:s(t).errors.consignee_id},null,8,["message"])])])]),e("div",Ze,[ze,Je,e("div",Xe,[e("div",et,[n(ce,{ref_key:"create_edit_carrier_ref",ref:G},null,512),n(k,{onClick:o[11]||(o[11]=l=>se(s(Y))),type:"button"},{default:p(()=>[v(" Edit"),tt]),_:1}),n(s(F),{style:{"margin-top":"3px !important"},searchable:!0,modelValue:s(t).carrier,"onUpdate:modelValue":o[12]||(o[12]=l=>s(t).carrier=l),options:b.carriers,onClick:o[13]||(o[13]=l=>te(s(t).carrier))},null,8,["modelValue","options"]),n(i,{message:s(t).errors.carrier},null,8,["message"])])])])]),st,e("div",ot,[lt,at,e("div",nt,[n(c,{for:"",value:"Departure Date & Time",class:"mb-1"}),n(s(P),{modelValue:s(t).departure_at,"onUpdate:modelValue":o[14]||(o[14]=l=>s(t).departure_at=l),teleport:!0,"is-24":!1},null,8,["modelValue"]),n(i,{message:s(t).errors.departure_at},null,8,["message"])]),e("div",rt,[n(c,{for:"",value:"Landing Date & Time",class:"mb-1"}),n(s(P),{modelValue:s(t).landing_at,"onUpdate:modelValue":o[15]||(o[15]=l=>s(t).landing_at=l),teleport:!0,"is-24":!1},null,8,["modelValue"]),n(i,{message:s(t).errors.landing_at},null,8,["message"])]),e("div",it,[n(c,{for:"",value:"Port of Departure",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":o[16]||(o[16]=l=>s(t).sender=l)},null,512),[[_,s(t).sender]]),n(i,{message:s(t).errors.sender},null,8,["message"])]),e("div",dt,[n(c,{for:"",value:"Port of Landing",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":o[17]||(o[17]=l=>s(t).destination=l)},null,512),[[_,s(t).destination]]),n(i,{message:s(t).errors.destination},null,8,["message"])]),e("div",ct,[n(c,{for:"",value:"Commodity",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":o[18]||(o[18]=l=>s(t).commodity=l)},null,512),[[_,s(t).commodity]]),n(i,{message:s(t).errors.commodity},null,8,["message"])]),e("div",ut,[n(c,{for:"",value:"Quantity",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":o[19]||(o[19]=l=>s(t).quantity=l)},null,512),[[_,s(t).quantity]]),n(i,{message:s(t).errors.quantity},null,8,["message"])]),e("div",mt,[n(c,{for:"",value:"Weight",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":o[20]||(o[20]=l=>s(t).weight=l)},null,512),[[_,s(t).weight]]),n(i,{message:s(t).errors.weight},null,8,["message"])]),e("div",_t,[n(c,{for:"",value:"AFC Rate/KG",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":o[21]||(o[21]=l=>s(t).afc_rate=l)},null,512),[[_,s(t).afc_rate]]),n(i,{message:s(t).errors.afc_rate},null,8,["message"])])]),s(f)=="invoice"?(u(),m(V,{key:0},[pt,ht,e("div",ft,[n(c,{for:"",value:"Templates",class:"mb-1"}),d(e("select",{class:"form-control","onUpdate:modelValue":o[22]||(o[22]=l=>s(t).template_id=l),onChange:o[23]||(o[23]=l=>ee(s(t).template_id))},[(u(!0),m(V,null,R(b.templates,l=>(u(),m("option",{key:l.id,value:l.id},h(l.title),9,gt))),128))],544),[[N,s(t).template_id]])]),vt,e("table",null,[e("thead",null,[e("tr",null,[e("th",bt,[e("button",{type:"button",onClick:o[24]||(o[24]=l=>z()),class:"ms-1 text-white btn btn-success btn-sm"},[yt,v("Add Item")])]),Vt,xt,Ct,wt])]),e("tbody",null,[(u(!0),m(V,null,R(s(t).items,(l,U)=>(u(),m("tr",{key:l.id},[e("td",Ut,[e("span",null,[v(" Item #"+h(U)+" ",1),e("button",{type:"button",onClick:g=>X(U),class:"ms-1 text-danger"},Tt,8,At)])]),e("td",$t,[d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":g=>l.particular=g},null,8,St),[[_,l.particular]])]),e("td",It,[d(e("input",{type:"number",class:"form-control",step:"0.01","onUpdate:modelValue":g=>l.amount=g,onKeyup:g=>M(U)},null,40,Et),[[_,l.amount]])]),e("td",Dt,[d(e("input",{type:"number",class:"form-control","onUpdate:modelValue":g=>l.qty=g,onKeyup:g=>M(U)},null,40,Nt),[[_,l.qty]])]),e("td",Rt,"PKR "+h(S(l.total)),1)]))),128))]),e("tfoot",null,[e("tr",null,[Pt,Ft,e("td",null,"PKR "+h(S(s(t).subtotal)),1)]),e("tr",null,[qt,Lt,e("td",null,"PKR "+h(S(s(t).total)),1)])])])],64)):x("",!0)])]),e("div",Mt,[e("div",Ot,[n(k,{disabled:s(t).processing},{default:p(()=>[v(h(s(y)?"Update":"Save"),1)]),_:1},8,["disabled"]),s(f)=="shipment"?(u(),H(s(j),{key:0,href:r.route("shipment.index")},{default:p(()=>[n(Q,{disabled:s(t).processing},{default:p(()=>[v(" Cancel ")]),_:1},8,["disabled"])]),_:1},8,["href"])):x("",!0),s(f)=="invoice"?(u(),H(s(j),{key:1,href:r.route("invoice.index")},{default:p(()=>[n(Q,{disabled:s(t).processing},{default:p(()=>[v(" Cancel ")]),_:1},8,["disabled"])]),_:1},8,["href"])):x("",!0)])])],32)])])])]),_:1})],64))}};export{os as default};
