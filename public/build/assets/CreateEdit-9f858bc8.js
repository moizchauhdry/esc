import{m as w,v as R,x as E,f as h,a as c,w as d,F as T,o as f,d as r,b as t,t as u,i as y,q as v,u as n,z as q,g as K,n as L,e as N}from"./app-b881675f.js";import{_ as P,a as D}from"./SecondaryButton-ec364de2.js";import{_ as M}from"./PrimaryButton-131ef9c0.js";import{_ as C}from"./SuccessButton-124cd9b2.js";import{_ as B}from"./InputError-f8d6341a.js";const O={class:"p-6"},z={class:"text-lg font-medium text-gray-900"},j=t("hr",null,null,-1),G={class:"mt-6"},Q={class:"row g-3"},Y={class:"col-md-12"},H=t("label",{for:"input13",class:"form-label"},"Template Title",-1),J={class:"position-relative input-icon"},W=t("span",{class:"position-absolute top-50 translate-middle-y"},[t("i",{class:"bx bx-user"})],-1),X={class:"row"},Z=t("div",{class:"my-3"},null,-1),tt={class:"invoice-heading"},et=t("i",{class:"bx bx-plus"},null,-1),st=t("hr",null,null,-1),ot={key:0},lt=t("thead",null,[t("tr",null,[t("th",{style:{width:"12%"}},"SR.NO."),t("th",{class:"text-left",colspan:"3",style:{width:"45%"}},"PARTICULARS"),t("th",{class:"text-left",style:{width:"15%"}},"PRICE"),t("th",{class:"text-left",style:{width:"10%"}},"QTY"),t("th",{class:"text-left",style:{width:"15%"}},"TOTAL")])],-1),at={class:"no",style:{width:"5%"}},nt=["onClick"],it=t("i",{class:"bx bxs-trash"},null,-1),ct=[it],rt={class:"text-left",colspan:"3",style:{width:"45%"}},dt=["onUpdate:modelValue"],ut={class:"text-left",style:{width:"15%"}},_t=["onUpdate:modelValue","onKeyup"],mt={class:"text-left",style:{width:"10%"}},pt=["onUpdate:modelValue","onKeyup"],ht={class:"total",style:{width:"1%"}},ft=t("th",{colspan:"4"},null,-1),yt=t("th",{colspan:"2"},"TOTAL",-1),vt={class:"mt-6 flex justify-end"},St={__name:"CreateEdit",props:{},setup(bt,{expose:S}){const _=w(!1),i=w(!1),e=R({template_id:"",title:"",items:[]}),U=()=>{_.value=!0,i.value=!1},V=()=>{e.post(route("template.store"),{preserveScroll:!0,onSuccess:s=>{m()},onError:s=>{console.log(s)},onFinish:()=>{}})},$=s=>{s&&(_.value=!0,i.value=!0,e.template_id=s.id,e.title=s.title,axios.get(`/templates/fetch/particulars/${s.id}`).then(({data:l})=>{e.items=l.particulars}))},k=()=>{e.post(route("template.update"),{preserveScroll:!0,onSuccess:()=>m(),onError:()=>A(),onFinish:()=>{}})},A=()=>{},m=()=>{_.value=!1,e.reset()},F=()=>{e.items.push({particular:"",amount:"",qty:1,total:0})},I=s=>{e.items.splice(s,1),b()},b=()=>{e.subtotal=0,e.items.forEach(s=>{e.subtotal+=parseFloat(s.total)}),e.total=e.subtotal},x=s=>{const l=e.items[s],o=l.qty*l.amount;l.total=o,b()},g=s=>new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(s);return S({edit:s=>$(s)}),E(()=>{i||(e.items=[{particular:"",amount:0,qty:1,total:0}]),i&&b()}),(s,l)=>(f(),h(T,null,[c(M,{onClick:U,type:"button"},{default:d(()=>[r("Add Template")]),_:1}),c(P,{show:_.value,onClose:m},{default:d(()=>[t("form",{onSubmit:l[2]||(l[2]=N(o=>i.value?k():V(),["prevent"]))},[t("div",O,[t("h2",z,"Template "+u(i.value?"Edit":"Create"),1),j,t("div",G,[t("div",Q,[t("div",Y,[H,t("div",J,[y(t("input",{type:"text",class:"form-control",id:"input13",placeholder:"Title","onUpdate:modelValue":l[0]||(l[0]=o=>n(e).title=o)},null,512),[[v,n(e).title]]),W]),c(B,{message:n(e).errors.title},null,8,["message"])])]),t("div",X,[Z,t("h6",tt,[r(" PARTICULARS "),c(C,{type:"button",class:"float-right",onClick:l[1]||(l[1]=o=>F())},{default:d(()=>[et,r("Add Item ")]),_:1})]),st,n(e).items.length>0?(f(),h("table",ot,[lt,t("tbody",null,[(f(!0),h(T,null,q(n(e).items,(o,p)=>(f(),h("tr",{key:o.id},[t("td",at,[t("span",null,[r(" Item #"+u(p)+" ",1),t("button",{type:"button",onClick:a=>I(p),class:"ms-1 text-danger"},ct,8,nt)])]),t("td",rt,[y(t("input",{type:"text",class:"form-control","onUpdate:modelValue":a=>o.particular=a},null,8,dt),[[v,o.particular]])]),t("td",ut,[y(t("input",{type:"number",class:"form-control","onUpdate:modelValue":a=>o.amount=a,onKeyup:a=>x(p)},null,40,_t),[[v,o.amount]])]),t("td",mt,[y(t("input",{type:"number",class:"form-control","onUpdate:modelValue":a=>o.qty=a,onKeyup:a=>x(p)},null,40,pt),[[v,o.qty]])]),t("th",ht,"PKR "+u(g(o.total)),1)]))),128))]),t("tfoot",null,[t("tr",null,[ft,yt,t("th",null,"PKR "+u(g(n(e).total)),1)])])])):K("",!0)])]),t("div",vt,[c(D,{onClick:m},{default:d(()=>[r(" Cancel ")]),_:1}),c(C,{class:L(["ml-3",{"opacity-25":n(e).processing}]),disabled:n(e).processing},{default:d(()=>[r(u(i.value?"Save & Update":"Save & Submit"),1)]),_:1},8,["class","disabled"])])])],32)]),_:1},8,["show"])],64))}};export{St as default};
