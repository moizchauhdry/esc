import{m as K,J as $,v as J,s as X,f as m,a,u as s,w as v,F as b,x as M,o as c,X as Y,b as e,t as _,e as z,g as w,i as d,p as S,y as A,q as p,d as h,c as B,l as O}from"./app-b94a3e9b.js";import{_ as ee}from"./AuthenticatedLayout-07514526.js";import{_ as i}from"./InputError-3fcba829.js";import{_ as E}from"./PrimaryButton-8b64c175.js";import{_ as G}from"./DangerButton-b8ee40cf.js";import j from"./CreateEdit-4c3c0262.js";import{Z as N}from"./main-3e7ba7ed.js";import{_ as u}from"./InputLabel-18c215fa.js";import"./SecondaryButton-ba4e9cbb.js";import"./SuccessButton-154f1105.js";const te={class:"page-wrapper"},se={class:"page-content"},oe={class:"page-breadcrumb d-none d-sm-flex align-items-center mb-3"},le=e("div",{class:"breadcrumb-title pe-3"},"Manage Shipments",-1),ne={class:"ps-3"},ae={"aria-label":"breadcrumb"},re={class:"breadcrumb mb-0 p-0"},de=e("li",{class:"breadcrumb-item"},[e("a",{href:"javascript:;"},[e("i",{class:"bx bx-home-alt"})])],-1),ie={class:"breadcrumb-item active","aria-current":"page"},ce=e("div",{class:"ms-auto"},null,-1),ue={class:"card"},me={class:"card-body"},_e={class:"invoice overflow-auto"},pe={class:"row"},he=e("h6",{class:"invoice-heading"},"INVOICE TO",-1),fe=e("hr",null,null,-1),ge={key:0,class:"col-md-2"},ve={class:"col-md-4"},be=["value"],ye={class:"col-md-2"},xe={class:"col-md-2"},we={key:1,class:"col-md-2"},Ve=e("option",{value:1},"Pending",-1),Ue=e("option",{value:2},"Approved",-1),Ce=e("option",{value:3},"Rejected",-1),Se=[Ve,Ue,Ce],Ae=e("div",{class:"my-3"},null,-1),Ie={class:"row"},ke={class:"col-md-4"},Te=e("h6",{class:"invoice-heading"},"SHIPPER",-1),$e=e("hr",null,null,-1),Ee={class:"row g-2"},Ne={class:"col-md-12"},Pe={for:"input13",class:"form-label"},Re=e("i",{class:"bx bx-edit ms-1"},null,-1),qe=["value"],De={class:"col-md-4"},Fe=e("h6",{class:"invoice-heading"},"CONSIGNEE",-1),Le=e("hr",null,null,-1),Ke={class:"row g-2"},Me={class:"col-md-12"},Be={for:"input13",class:"form-label"},Oe=e("i",{class:"bx bx-edit ms-1"},null,-1),Ge=["value"],je=e("div",{class:"my-3"},null,-1),He={class:"row g-2"},Qe=e("h6",{class:"invoice-heading"},"SHIPMENT DETAIL",-1),We=e("hr",null,null,-1),Ze={class:"col-md-3"},Je={class:"col-md-3"},Xe={class:"col-md-3"},Ye={class:"col-md-3"},ze={class:"col-md-6"},et={class:"col-md-1"},tt={class:"col-md-1"},st={class:"col-md-1"},ot=e("div",{class:"my-3"},null,-1),lt=e("h6",{class:"invoice-heading"},"PARTICULARS",-1),nt=e("hr",null,null,-1),at={style:{width:"5%"}},rt=e("i",{class:"bx bx-plus"},null,-1),dt=e("th",{class:"text-left",colspan:"3",style:{width:"45%"}},"PARTICULARS",-1),it=e("th",{class:"text-left",style:{width:"15%"}},"UNIT PRICE",-1),ct=e("th",{class:"text-left",style:{width:"10%"}},"QUANTITY",-1),ut=e("th",{class:"text-left",style:{width:"15%"}},"TOTAL",-1),mt={class:"no",style:{width:"5%"}},_t=["onClick"],pt=e("i",{class:"bx bxs-trash"},null,-1),ht=[pt],ft={class:"text-left",colspan:"3",style:{width:"45%"}},gt=["onUpdate:modelValue"],vt={class:"text-left",style:{width:"15%"}},bt=["onUpdate:modelValue","onKeyup"],yt={class:"text-left",style:{width:"10%"}},xt=["onUpdate:modelValue","onKeyup"],wt={class:"total",style:{width:"15%"}},Vt=e("td",{colspan:"4"},null,-1),Ut=e("td",{colspan:"2"},"SUBTOTAL",-1),Ct=e("td",{colspan:"4"},null,-1),St=e("td",{colspan:"2"},"GRAND TOTAL",-1),At={class:"card-footer"},It={class:"flex items-center gap-2 mt-2"},Lt={__name:"CreateInvoice",props:{invoice:Object,shippers:Array,consignees:Array,companies:Array,roles:Array,edit_mode:Boolean,page_type:String},setup(y){const H=K(!1),n=$().props.invoice,x=$().props.edit_mode,f=$().props.page_type;var P="",R="";const t=J({invoice_id:n==null?void 0:n.id,invoice_at:n==null?void 0:n.invoice_at,company_id:n==null?void 0:n.company_id,shipper_id:n==null?void 0:n.shipper_id,consignee_id:n==null?void 0:n.consignee_id,carrier:n==null?void 0:n.carrier,mawb_no:n==null?void 0:n.mawb_no,commodity:n==null?void 0:n.commodity,quantity:n==null?void 0:n.quantity,weight:n==null?void 0:n.weight,afc_rate:n==null?void 0:n.afc_rate,departure_at:n==null?void 0:n.departure_at,landing_at:n==null?void 0:n.landing_at,sender:n==null?void 0:n.sender,destination:n==null?void 0:n.destination,subtotal:0,total:0,items:n==null?void 0:n.items,status_id:n==null?void 0:n.status_id}),Q=()=>{t.items.push({particular:"",amount:"",qty:1,total:0})},W=()=>{console.log(f),f=="shipment"?x?t.post(route("shipment.update"),{preserveScroll:!0,onSuccess:()=>U(),onError:()=>V(),onFinish:()=>{}}):t.post(route("shipment.store"),{preserveScroll:!0,onSuccess:()=>U(),onError:()=>V(),onFinish:()=>{}}):f=="invoice"?t.post(route("invoice.update"),{preserveScroll:!0,onSuccess:()=>U(),onError:()=>V(),onFinish:()=>{}}):t.post(route("invoice.store"),{preserveScroll:!0,onSuccess:()=>U(),onError:()=>V(),onFinish:()=>{}})},V=()=>{},U=()=>{H.value=!1,t.reset()},Z=r=>{t.items.splice(r,1),I()},I=()=>{t.subtotal=0,t.items.forEach(r=>{t.subtotal+=parseFloat(r.total)}),t.total=t.subtotal},q=r=>{const l=t.items[r],o=l.qty*l.amount;l.total=o,I()},D=r=>{M.get(`/users/fetch/shipper/${r}`).then(({data:l})=>{P=l.selected_shipper})},F=r=>{M.get(`/users/fetch/consignee/${r}`).then(({data:l})=>{R=l.selected_consignee})},k=K(null),L=r=>{k.value.edit(r)},T=r=>new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(r);return X(()=>{x||(t.items=[{particular:"",amount:0,qty:1,total:0}]),x&&I(),D(t.shipper_id),F(t.consignee_id)}),(r,l)=>(c(),m(b,null,[a(s(Y),{title:"Invoices"}),a(ee,null,{default:v(()=>[e("div",te,[e("div",se,[e("div",oe,[le,e("div",ne,[e("nav",ae,[e("ol",re,[de,e("li",ie,_(s(x)?"Create":"Edit"),1)])])]),ce]),e("div",ue,[e("form",{onSubmit:l[21]||(l[21]=z(o=>W(),["prevent"]))},[e("div",me,[e("div",_e,[e("div",pe,[he,fe,s(f)=="invoice"?(c(),m("div",ge,[a(u,{for:"",value:"Invoice Date",class:"mb-1"}),a(s(N),{modelValue:s(t).invoice_at,"onUpdate:modelValue":l[0]||(l[0]=o=>s(t).invoice_at=o),teleport:!0,"enable-time-picker":!1},null,8,["modelValue"]),a(i,{message:s(t).errors.invoice_at},null,8,["message"])])):w("",!0),e("div",ve,[a(u,{for:"",value:"Company Account",class:"mb-1"}),d(e("select",{class:"form-control","onUpdate:modelValue":l[1]||(l[1]=o=>s(t).company_id=o),onChange:l[2]||(l[2]=o=>r.fetchAddress("company"))},[(c(!0),m(b,null,A(y.companies,o=>(c(),m("option",{key:o.id,value:o.id},_(o.id)+" - "+_(o.name),9,be))),128))],544),[[S,s(t).company_id]]),a(i,{message:s(t).errors.company_id},null,8,["message"])]),e("div",ye,[a(u,{for:"",value:"MAWB No",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[3]||(l[3]=o=>s(t).mawb_no=o)},null,512),[[p,s(t).mawb_no]]),a(i,{message:s(t).errors.mawb_no},null,8,["message"])]),e("div",xe,[a(u,{for:"",value:"Carrier",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[4]||(l[4]=o=>s(t).carrier=o)},null,512),[[p,s(t).carrier]]),a(i,{message:s(t).errors.carrier},null,8,["message"])]),s(f)=="invoice"?(c(),m("div",we,[a(u,{for:"",value:"Invoice Status",class:"mb-1"}),d(e("select",{class:"form-control","onUpdate:modelValue":l[5]||(l[5]=o=>s(t).status_id=o)},Se,512),[[S,s(t).status_id]]),a(i,{message:s(t).errors.status_id},null,8,["message"])])):w("",!0)]),Ae,e("div",Ie,[e("div",ke,[Te,$e,e("div",Ee,[e("div",Ne,[e("label",Pe,[h("Account Number "),a(j,{roles:y.roles,selected_role:3,ref_key:"create_edit_ref",ref:k},null,8,["roles"]),a(E,{onClick:l[6]||(l[6]=o=>L(s(P))),type:"button"},{default:v(()=>[h("Edit "),Re]),_:1})]),d(e("select",{class:"form-control","onUpdate:modelValue":l[7]||(l[7]=o=>s(t).shipper_id=o),onChange:l[8]||(l[8]=o=>D(s(t).shipper_id))},[(c(!0),m(b,null,A(y.shippers,o=>(c(),m("option",{key:o.id,value:o.id},_(o.id)+" - "+_(o.name),9,qe))),128))],544),[[S,s(t).shipper_id]]),a(i,{message:s(t).errors.shipper_id},null,8,["message"])])])]),e("div",De,[Fe,Le,e("div",Ke,[e("div",Me,[e("label",Be,[h("Account Number "),a(j,{roles:y.roles,selected_role:4,ref_key:"create_edit_ref",ref:k},null,8,["roles"]),a(E,{onClick:l[9]||(l[9]=o=>L(s(R))),type:"button"},{default:v(()=>[h("Edit "),Oe]),_:1})]),d(e("select",{class:"form-control","onUpdate:modelValue":l[10]||(l[10]=o=>s(t).consignee_id=o),onChange:l[11]||(l[11]=o=>F(s(t).consignee_id))},[(c(!0),m(b,null,A(y.consignees,o=>(c(),m("option",{key:o.id,value:o.id},_(o.id)+" - "+_(o.name),9,Ge))),128))],544),[[S,s(t).consignee_id]]),a(i,{message:s(t).errors.consignee_id},null,8,["message"])])])])]),je,e("div",He,[Qe,We,e("div",Ze,[a(u,{for:"",value:"Departure Date",class:"mb-1"}),a(s(N),{modelValue:s(t).departure_at,"onUpdate:modelValue":l[12]||(l[12]=o=>s(t).departure_at=o),teleport:!0},null,8,["modelValue"]),a(i,{message:s(t).errors.departure_at},null,8,["message"])]),e("div",Je,[a(u,{for:"",value:"Landing Date",class:"mb-1"}),a(s(N),{modelValue:s(t).landing_at,"onUpdate:modelValue":l[13]||(l[13]=o=>s(t).landing_at=o),teleport:!0},null,8,["modelValue"]),a(i,{message:s(t).errors.landing_at},null,8,["message"])]),e("div",Xe,[a(u,{for:"",value:"Port of Departure",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[14]||(l[14]=o=>s(t).sender=o)},null,512),[[p,s(t).sender]]),a(i,{message:s(t).errors.sender},null,8,["message"])]),e("div",Ye,[a(u,{for:"",value:"Port of Landing",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[15]||(l[15]=o=>s(t).destination=o)},null,512),[[p,s(t).destination]]),a(i,{message:s(t).errors.destination},null,8,["message"])]),e("div",ze,[a(u,{for:"",value:"Commodity",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[16]||(l[16]=o=>s(t).commodity=o)},null,512),[[p,s(t).commodity]]),a(i,{message:s(t).errors.commodity},null,8,["message"])]),e("div",et,[a(u,{for:"",value:"Quantity",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[17]||(l[17]=o=>s(t).quantity=o)},null,512),[[p,s(t).quantity]]),a(i,{message:s(t).errors.quantity},null,8,["message"])]),e("div",tt,[a(u,{for:"",value:"Weight",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[18]||(l[18]=o=>s(t).weight=o)},null,512),[[p,s(t).weight]]),a(i,{message:s(t).errors.weight},null,8,["message"])]),e("div",st,[a(u,{for:"",value:"AFC Rate/KG",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[19]||(l[19]=o=>s(t).afc_rate=o)},null,512),[[p,s(t).afc_rate]]),a(i,{message:s(t).errors.afc_rate},null,8,["message"])])]),s(f)=="invoice"?(c(),m(b,{key:0},[ot,lt,nt,e("table",null,[e("thead",null,[e("tr",null,[e("th",at,[e("button",{type:"button",onClick:l[20]||(l[20]=o=>Q()),class:"ms-1 text-sucess btn btn-success btn-sm"},[rt,h("Add Item")])]),dt,it,ct,ut])]),e("tbody",null,[(c(!0),m(b,null,A(s(t).items,(o,C)=>(c(),m("tr",{key:o.id},[e("td",mt,[e("span",null,[h(" Item #"+_(C)+" ",1),e("button",{type:"button",onClick:g=>Z(C),class:"ms-1 text-danger"},ht,8,_t)])]),e("td",ft,[d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":g=>o.particular=g},null,8,gt),[[p,o.particular]])]),e("td",vt,[d(e("input",{type:"number",class:"form-control","onUpdate:modelValue":g=>o.amount=g,onKeyup:g=>q(C)},null,40,bt),[[p,o.amount]])]),e("td",yt,[d(e("input",{type:"number",class:"form-control","onUpdate:modelValue":g=>o.qty=g,onKeyup:g=>q(C)},null,40,xt),[[p,o.qty]])]),e("td",wt,"PKR "+_(T(o.total)),1)]))),128))]),e("tfoot",null,[e("tr",null,[Vt,Ut,e("td",null,"PKR "+_(T(s(t).subtotal)),1)]),e("tr",null,[Ct,St,e("td",null,"PKR "+_(T(s(t).total)),1)])])])],64)):w("",!0)])]),e("div",At,[e("div",It,[a(E,{disabled:s(t).processing},{default:v(()=>[h(_(s(x)?"Update":"Save"),1)]),_:1},8,["disabled"]),s(f)=="shipment"?(c(),B(s(O),{key:0,href:r.route("shipment.index")},{default:v(()=>[a(G,{disabled:s(t).processing},{default:v(()=>[h(" Cancel ")]),_:1},8,["disabled"])]),_:1},8,["href"])):w("",!0),s(f)=="invoice"?(c(),B(s(O),{key:1,href:r.route("invoice.index")},{default:v(()=>[a(G,{disabled:s(t).processing},{default:v(()=>[h(" Cancel ")]),_:1},8,["disabled"])]),_:1},8,["href"])):w("",!0)])])],32)])])])]),_:1})],64))}};export{Lt as default};
