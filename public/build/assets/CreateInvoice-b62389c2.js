import{m as B,J as T,v as X,s as ee,x as te,f as _,a as n,u as s,w as v,F as x,y as $,o as u,X as se,b as e,t as p,e as oe,g as V,i as d,p as D,z as E,q as m,d as h,c as O,l as Y}from"./app-b881675f.js";import{_ as le}from"./AuthenticatedLayout-18a79249.js";import{_ as i}from"./InputError-f8d6341a.js";import{_ as N}from"./PrimaryButton-131ef9c0.js";import{_ as G}from"./DangerButton-35424ab6.js";import H from"./CreateEdit-386564e2.js";import{Z as P}from"./main-36f377c1.js";import{_ as c}from"./InputLabel-87be91b7.js";import{h as ae}from"./moment-a9aaa855.js";import{s as j}from"./multiselect-22d70923.js";/* empty css                                                         */import"./index-3b718693.js";import"./SecondaryButton-ec364de2.js";import"./SuccessButton-124cd9b2.js";const ne={class:"page-wrapper"},re={class:"page-content"},ie={class:"page-breadcrumb d-none d-sm-flex align-items-center mb-3"},de=e("div",{class:"breadcrumb-title pe-3"},"Manage Shipments",-1),ce={class:"ps-3"},ue={"aria-label":"breadcrumb"},me={class:"breadcrumb mb-0 p-0"},_e=e("li",{class:"breadcrumb-item"},[e("a",{href:"javascript:;"},[e("i",{class:"bx bx-home-alt"})])],-1),pe={class:"breadcrumb-item active","aria-current":"page"},he=e("div",{class:"ms-auto"},null,-1),fe={class:"card"},ge={class:"card-body"},ve={class:"invoice overflow-auto"},be={class:"row"},ye=e("h6",{class:"invoice-heading"},"INVOICE TO",-1),xe=e("hr",null,null,-1),Ve={key:0,class:"col-md-3"},we={class:"col-md-3"},Ue=["value"],Ce={class:"col-md-2"},Ae={class:"col-md-2"},Se={key:1,class:"col-md-2"},ke=e("option",{value:1},"Pending",-1),Ie=e("option",{value:2},"Approved",-1),Te=e("option",{value:3},"Rejected",-1),$e=[ke,Ie,Te],De=e("div",{class:"my-3"},null,-1),Ee={class:"row"},Ne={class:"col-md-4"},Pe=e("h6",{class:"invoice-heading"},"SHIPPER",-1),Re=e("hr",null,null,-1),qe={class:"row g-2"},Fe={class:"col-md-12"},Le={for:"input13",class:"form-label"},Me=e("i",{class:"bx bx-edit ms-1"},null,-1),Ke={class:"col-md-4"},Be=e("h6",{class:"invoice-heading"},"CONSIGNEE",-1),Oe=e("hr",null,null,-1),Ye={class:"row g-2"},Ge={class:"col-md-12"},He={for:"input13",class:"form-label"},je=e("i",{class:"bx bx-edit ms-1"},null,-1),Qe=e("div",{class:"my-3"},null,-1),We={class:"row g-2"},Ze=e("h6",{class:"invoice-heading"},"SHIPMENT DETAIL",-1),ze=e("hr",null,null,-1),Je={class:"col-md-3"},Xe={class:"col-md-3"},et={class:"col-md-3"},tt={class:"col-md-3"},st={class:"col-md-6"},ot={class:"col-md-1"},lt={class:"col-md-1"},at={class:"col-md-1"},nt=e("div",{class:"my-3"},null,-1),rt=e("h6",{class:"invoice-heading"},"PARTICULARS",-1),it={class:"col-md-6"},dt=["value"],ct=e("hr",null,null,-1),ut={style:{width:"5%"}},mt=e("i",{class:"bx bx-plus"},null,-1),_t=e("th",{class:"text-left",colspan:"3",style:{width:"45%"}},"PARTICULARS",-1),pt=e("th",{class:"text-left",style:{width:"15%"}},"UNIT PRICE",-1),ht=e("th",{class:"text-left",style:{width:"10%"}},"QUANTITY",-1),ft=e("th",{class:"text-left",style:{width:"15%"}},"TOTAL",-1),gt={class:"no",style:{width:"5%"}},vt=["onClick"],bt=e("i",{class:"bx bxs-trash"},null,-1),yt=[bt],xt={class:"text-left",colspan:"3",style:{width:"45%"}},Vt=["onUpdate:modelValue"],wt={class:"text-left",style:{width:"15%"}},Ut=["onUpdate:modelValue","onKeyup"],Ct={class:"text-left",style:{width:"10%"}},At=["onUpdate:modelValue","onKeyup"],St={class:"total",style:{width:"15%"}},kt=e("td",{colspan:"4"},null,-1),It=e("td",{colspan:"2"},"SUBTOTAL",-1),Tt=e("td",{colspan:"4"},null,-1),$t=e("td",{colspan:"2"},"GRAND TOTAL",-1),Dt={class:"card-footer"},Et={class:"flex items-center gap-2 mt-2"},Qt={__name:"CreateInvoice",props:{invoice:Object,shippers:Array,consignees:Array,companies:Array,roles:Array,edit_mode:Boolean,page_type:String,templates:Array},setup(b){const Q=B(!1),a=T().props.invoice,y=T().props.edit_mode,f=T().props.page_type;var R="",q="";const t=X({invoice_id:a==null?void 0:a.id,invoice_at:a==null?void 0:a.invoice_at,company_id:a==null?void 0:a.company_id,shipper_id:a==null?void 0:a.shipper_id,consignee_id:a==null?void 0:a.consignee_id,carrier:a==null?void 0:a.carrier,mawb_no:a==null?void 0:a.mawb_no,commodity:a==null?void 0:a.commodity,quantity:a==null?void 0:a.quantity,weight:a==null?void 0:a.weight,afc_rate:a==null?void 0:a.afc_rate,departure_at:a==null?void 0:a.departure_at,landing_at:a==null?void 0:a.landing_at,sender:a==null?void 0:a.sender,destination:a==null?void 0:a.destination,subtotal:0,total:0,items:a==null?void 0:a.items,status_id:a==null?void 0:a.status_id}),W=()=>{t.items.push({particular:"",amount:"",qty:1,total:0})},Z=()=>{console.log(f),f=="shipment"?y?t.post(route("shipment.update"),{preserveScroll:!0,onSuccess:()=>U(),onError:()=>w(),onFinish:()=>{}}):t.post(route("shipment.store"),{preserveScroll:!0,onSuccess:()=>U(),onError:()=>w(),onFinish:()=>{}}):f=="invoice"?t.post(route("invoice.update"),{preserveScroll:!0,onSuccess:()=>U(),onError:()=>w(),onFinish:()=>{}}):t.post(route("invoice.store"),{preserveScroll:!0,onSuccess:()=>U(),onError:()=>w(),onFinish:()=>{}})},w=()=>{},U=()=>{Q.value=!1,t.reset()},z=r=>{t.items.splice(r,1),A()},A=()=>{t.subtotal=0,t.items.forEach(r=>{t.subtotal+=parseFloat(r.total)}),t.total=t.subtotal},F=r=>{const l=t.items[r],o=l.qty*l.amount;l.total=o,A()},L=r=>{r&&$.get(`/users/fetch/shipper/${r}`).then(({data:l})=>{R=l.selected_shipper})},M=r=>{r&&$.get(`/users/fetch/consignee/${r}`).then(({data:l})=>{q=l.selected_consignee})},S=B(null),K=r=>{S.value.edit(r)},k=r=>new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(r),I=r=>ae(r).format("YYYY-MM-DD HH:mm");ee(()=>{t.departure_at&&(t.departure_at=I(t.departure_at)),t.landing_at&&(t.landing_at=I(t.landing_at)),t.invoice_at&&(t.invoice_at=I(t.invoice_at))}),te(()=>{y||(t.items=[{particular:"",amount:0,qty:1,total:0}]),y&&A(),L(t.shipper_id),M(t.consignee_id)});const J=r=>{$.get(`/templates/fetch/particulars/${r}`).then(({data:l})=>{t.items=l.particulars})};return(r,l)=>(u(),_(x,null,[n(s(se),{title:"Invoices"}),n(le,null,{default:v(()=>[e("div",ne,[e("div",re,[e("div",ie,[de,e("div",ce,[e("nav",ue,[e("ol",me,[_e,e("li",pe,p(s(y)?"Create":"Edit"),1)])])]),he]),e("div",fe,[e("form",{onSubmit:l[23]||(l[23]=oe(o=>Z(),["prevent"]))},[e("div",ge,[e("div",ve,[e("div",be,[ye,xe,s(f)=="invoice"?(u(),_("div",Ve,[n(c,{for:"",value:"Invoice Date",class:"mb-1"}),n(s(P),{modelValue:s(t).invoice_at,"onUpdate:modelValue":l[0]||(l[0]=o=>s(t).invoice_at=o),teleport:!0},null,8,["modelValue"]),n(i,{message:s(t).errors.invoice_at},null,8,["message"])])):V("",!0),e("div",we,[n(c,{for:"",value:"Company Account",class:"mb-1"}),d(e("select",{class:"form-control","onUpdate:modelValue":l[1]||(l[1]=o=>s(t).company_id=o),onChange:l[2]||(l[2]=o=>r.fetchAddress("company"))},[(u(!0),_(x,null,E(b.companies,o=>(u(),_("option",{key:o.id,value:o.id},p(o.id)+" - "+p(o.name),9,Ue))),128))],544),[[D,s(t).company_id]]),n(i,{message:s(t).errors.company_id},null,8,["message"])]),e("div",Ce,[n(c,{for:"",value:"MAWB No",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[3]||(l[3]=o=>s(t).mawb_no=o)},null,512),[[m,s(t).mawb_no]]),n(i,{message:s(t).errors.mawb_no},null,8,["message"])]),e("div",Ae,[n(c,{for:"",value:"Carrier",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[4]||(l[4]=o=>s(t).carrier=o)},null,512),[[m,s(t).carrier]]),n(i,{message:s(t).errors.carrier},null,8,["message"])]),s(f)=="invoice"?(u(),_("div",Se,[n(c,{for:"",value:"Invoice Status",class:"mb-1"}),d(e("select",{class:"form-control","onUpdate:modelValue":l[5]||(l[5]=o=>s(t).status_id=o)},$e,512),[[D,s(t).status_id]]),n(i,{message:s(t).errors.status_id},null,8,["message"])])):V("",!0)]),De,e("div",Ee,[e("div",Ne,[Pe,Re,e("div",qe,[e("div",Fe,[e("label",Le,[h("Account Number "),n(H,{roles:b.roles,selected_role:3,ref_key:"create_edit_ref",ref:S},null,8,["roles"]),n(N,{onClick:l[6]||(l[6]=o=>K(s(R))),type:"button"},{default:v(()=>[h("Edit "),Me]),_:1})]),n(s(j),{style:{"margin-top":"3px !important"},searchable:!0,modelValue:s(t).shipper_id,"onUpdate:modelValue":l[7]||(l[7]=o=>s(t).shipper_id=o),options:b.shippers,onClick:l[8]||(l[8]=o=>L(s(t).shipper_id))},null,8,["modelValue","options"]),n(i,{message:s(t).errors.shipper_id},null,8,["message"])])])]),e("div",Ke,[Be,Oe,e("div",Ye,[e("div",Ge,[e("label",He,[h("Account Number "),n(H,{roles:b.roles,selected_role:4,ref_key:"create_edit_ref",ref:S},null,8,["roles"]),n(N,{onClick:l[9]||(l[9]=o=>K(s(q))),type:"button"},{default:v(()=>[h("Edit "),je]),_:1})]),n(s(j),{style:{"margin-top":"3px !important"},searchable:!0,modelValue:s(t).consignee_id,"onUpdate:modelValue":l[10]||(l[10]=o=>s(t).consignee_id=o),options:b.consignees,onClick:l[11]||(l[11]=o=>M(s(t).consignee_id))},null,8,["modelValue","options"]),n(i,{message:s(t).errors.consignee_id},null,8,["message"])])])])]),Qe,e("div",We,[Ze,ze,e("div",Je,[n(c,{for:"",value:"Departure Date",class:"mb-1"}),n(s(P),{modelValue:s(t).departure_at,"onUpdate:modelValue":l[12]||(l[12]=o=>s(t).departure_at=o),teleport:!0,"is-24":!1},null,8,["modelValue"]),n(i,{message:s(t).errors.departure_at},null,8,["message"])]),e("div",Xe,[n(c,{for:"",value:"Landing Date",class:"mb-1"}),n(s(P),{modelValue:s(t).landing_at,"onUpdate:modelValue":l[13]||(l[13]=o=>s(t).landing_at=o),teleport:!0,"is-24":!1},null,8,["modelValue"]),n(i,{message:s(t).errors.landing_at},null,8,["message"])]),e("div",et,[n(c,{for:"",value:"Port of Departure",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[14]||(l[14]=o=>s(t).sender=o)},null,512),[[m,s(t).sender]]),n(i,{message:s(t).errors.sender},null,8,["message"])]),e("div",tt,[n(c,{for:"",value:"Port of Landing",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[15]||(l[15]=o=>s(t).destination=o)},null,512),[[m,s(t).destination]]),n(i,{message:s(t).errors.destination},null,8,["message"])]),e("div",st,[n(c,{for:"",value:"Commodity",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[16]||(l[16]=o=>s(t).commodity=o)},null,512),[[m,s(t).commodity]]),n(i,{message:s(t).errors.commodity},null,8,["message"])]),e("div",ot,[n(c,{for:"",value:"Quantity",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[17]||(l[17]=o=>s(t).quantity=o)},null,512),[[m,s(t).quantity]]),n(i,{message:s(t).errors.quantity},null,8,["message"])]),e("div",lt,[n(c,{for:"",value:"Weight",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[18]||(l[18]=o=>s(t).weight=o)},null,512),[[m,s(t).weight]]),n(i,{message:s(t).errors.weight},null,8,["message"])]),e("div",at,[n(c,{for:"",value:"AFC Rate/KG",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[19]||(l[19]=o=>s(t).afc_rate=o)},null,512),[[m,s(t).afc_rate]]),n(i,{message:s(t).errors.afc_rate},null,8,["message"])])]),s(f)=="invoice"?(u(),_(x,{key:0},[nt,rt,e("div",it,[n(c,{for:"",value:"Templates",class:"mb-1"}),d(e("select",{class:"form-control","onUpdate:modelValue":l[20]||(l[20]=o=>s(t).template_id=o),onChange:l[21]||(l[21]=o=>J(s(t).template_id))},[(u(!0),_(x,null,E(b.templates,o=>(u(),_("option",{key:o.id,value:o.id},p(o.title),9,dt))),128))],544),[[D,s(t).template_id]])]),ct,e("table",null,[e("thead",null,[e("tr",null,[e("th",ut,[e("button",{type:"button",onClick:l[22]||(l[22]=o=>W()),class:"ms-1 text-sucess btn btn-success btn-sm"},[mt,h("Add Item")])]),_t,pt,ht,ft])]),e("tbody",null,[(u(!0),_(x,null,E(s(t).items,(o,C)=>(u(),_("tr",{key:o.id},[e("td",gt,[e("span",null,[h(" Item #"+p(C)+" ",1),e("button",{type:"button",onClick:g=>z(C),class:"ms-1 text-danger"},yt,8,vt)])]),e("td",xt,[d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":g=>o.particular=g},null,8,Vt),[[m,o.particular]])]),e("td",wt,[d(e("input",{type:"number",class:"form-control","onUpdate:modelValue":g=>o.amount=g,onKeyup:g=>F(C)},null,40,Ut),[[m,o.amount]])]),e("td",Ct,[d(e("input",{type:"number",class:"form-control","onUpdate:modelValue":g=>o.qty=g,onKeyup:g=>F(C)},null,40,At),[[m,o.qty]])]),e("td",St,"PKR "+p(k(o.total)),1)]))),128))]),e("tfoot",null,[e("tr",null,[kt,It,e("td",null,"PKR "+p(k(s(t).subtotal)),1)]),e("tr",null,[Tt,$t,e("td",null,"PKR "+p(k(s(t).total)),1)])])])],64)):V("",!0)])]),e("div",Dt,[e("div",Et,[n(N,{disabled:s(t).processing},{default:v(()=>[h(p(s(y)?"Update":"Save"),1)]),_:1},8,["disabled"]),s(f)=="shipment"?(u(),O(s(Y),{key:0,href:r.route("shipment.index")},{default:v(()=>[n(G,{disabled:s(t).processing},{default:v(()=>[h(" Cancel ")]),_:1},8,["disabled"])]),_:1},8,["href"])):V("",!0),s(f)=="invoice"?(u(),O(s(Y),{key:1,href:r.route("invoice.index")},{default:v(()=>[n(G,{disabled:s(t).processing},{default:v(()=>[h(" Cancel ")]),_:1},8,["disabled"])]),_:1},8,["href"])):V("",!0)])])],32)])])])]),_:1})],64))}};export{Qt as default};
