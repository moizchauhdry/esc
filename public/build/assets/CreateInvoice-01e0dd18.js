import{m as F,J as k,v as Z,s as J,f as _,a,u as s,w as g,F as b,x as K,o as c,X,b as e,t as u,e as Y,g as w,i as d,p as T,y as A,q as p,d as f,c as M,l as B}from"./app-c19afc6b.js";import{_ as z}from"./AuthenticatedLayout-0d7f1b7d.js";import{_ as i}from"./InputError-c1d8afd0.js";import{_ as $}from"./PrimaryButton-baff175d.js";import{_ as O}from"./DangerButton-7fc0aaf1.js";import G from"./CreateEdit-219bf73d.js";import{Z as E}from"./main-c034942b.js";import{_ as m}from"./InputLabel-74cdd2e2.js";import"./SecondaryButton-383a19cc.js";import"./SuccessButton-2bac010f.js";const ee={class:"page-wrapper"},te={class:"page-content"},se={class:"page-breadcrumb d-none d-sm-flex align-items-center mb-3"},oe=e("div",{class:"breadcrumb-title pe-3"},"Manage Shipments",-1),le={class:"ps-3"},ne={"aria-label":"breadcrumb"},ae={class:"breadcrumb mb-0 p-0"},re=e("li",{class:"breadcrumb-item"},[e("a",{href:"javascript:;"},[e("i",{class:"bx bx-home-alt"})])],-1),de={class:"breadcrumb-item active","aria-current":"page"},ie=e("div",{class:"ms-auto"},null,-1),ce={class:"card"},ue={class:"card-body"},me={class:"invoice overflow-auto"},_e={class:"row"},pe=e("h6",{class:"invoice-heading"},"INVOICE TO",-1),fe=e("hr",null,null,-1),he={key:0,class:"col-md-2"},ge={class:"col-md-2"},ve=["value"],be={class:"col-md-2"},ye={class:"col-md-2"},xe=e("div",{class:"my-3"},null,-1),Ve={class:"row"},Ue={class:"col-md-4"},Ce=e("h6",{class:"invoice-heading"},"SHIPPER",-1),we=e("hr",null,null,-1),Ae={class:"row g-2"},Se={class:"col-md-12"},Ie={for:"input13",class:"form-label"},ke=e("i",{class:"bx bx-edit ms-1"},null,-1),Te=["value"],$e={class:"col-md-4"},Ee=e("h6",{class:"invoice-heading"},"CONSIGNEE",-1),Ne=e("hr",null,null,-1),qe={class:"row g-2"},Pe={class:"col-md-12"},Re={for:"input13",class:"form-label"},Le=e("i",{class:"bx bx-edit ms-1"},null,-1),De=["value"],Fe=e("div",{class:"my-3"},null,-1),Ke={class:"row g-2"},Me=e("h6",{class:"invoice-heading"},"SHIPMENT DETAIL",-1),Be=e("hr",null,null,-1),Oe={class:"col-md-3"},Ge={class:"col-md-3"},je={class:"col-md-3"},He={class:"col-md-3"},Qe={class:"col-md-6"},We={class:"col-md-1"},Ze={class:"col-md-1"},Je={class:"col-md-1"},Xe=e("div",{class:"my-3"},null,-1),Ye=e("h6",{class:"invoice-heading"},"PARTICULARS",-1),ze=e("hr",null,null,-1),et=e("i",{class:"bx bx-plus"},null,-1),tt=e("th",{class:"text-left",colspan:"3"},"PARTICULARS",-1),st=e("th",{class:"text-left"},"UNIT PRICE",-1),ot=e("th",{class:"text-left"},"QUANTITY",-1),lt=e("th",{class:"text-left"},"TOTAL",-1),nt={class:"no"},at=["onClick"],rt=e("i",{class:"bx bxs-trash"},null,-1),dt=[rt],it={class:"text-left",colspan:"3"},ct=["onUpdate:modelValue"],ut={class:"text-left"},mt=["onUpdate:modelValue","onKeyup"],_t={class:"text-left"},pt=["onUpdate:modelValue","onKeyup"],ft={class:"total"},ht=e("td",{colspan:"4"},null,-1),gt=e("td",{colspan:"2"},"SUBTOTAL",-1),vt=e("td",{colspan:"4"},null,-1),bt=e("td",{colspan:"2"},"GRAND TOTAL",-1),yt={class:"card-footer"},xt={class:"flex items-center gap-2 mt-2"},Et={__name:"CreateInvoice",props:{invoice:Object,shippers:Array,consignees:Array,companies:Array,roles:Array,edit_mode:Boolean,page_type:String},setup(y){const j=F(!1),n=k().props.invoice,x=k().props.edit_mode,v=k().props.page_type;var N="",q="";const t=Z({invoice_id:n==null?void 0:n.id,invoice_at:n==null?void 0:n.invoice_at,company_id:n==null?void 0:n.company_id,shipper_id:n==null?void 0:n.shipper_id,consignee_id:n==null?void 0:n.consignee_id,carrier:n==null?void 0:n.carrier,mawb_no:n==null?void 0:n.mawb_no,commodity:n==null?void 0:n.commodity,quantity:n==null?void 0:n.quantity,weight:n==null?void 0:n.weight,afc_rate:n==null?void 0:n.afc_rate,departure_at:n==null?void 0:n.departure_at,landing_at:n==null?void 0:n.landing_at,sender:n==null?void 0:n.sender,destination:n==null?void 0:n.destination,subtotal:0,total:0,items:n==null?void 0:n.items}),H=()=>{t.items.push({particular:"",amount:0,qty:1,total:0})},Q=()=>{console.log(v),v=="shipment"?x?t.post(route("shipment.update"),{preserveScroll:!0,onSuccess:()=>U(),onError:()=>V(),onFinish:()=>{}}):t.post(route("shipment.store"),{preserveScroll:!0,onSuccess:()=>U(),onError:()=>V(),onFinish:()=>{}}):v=="invoice"?t.post(route("invoice.update"),{preserveScroll:!0,onSuccess:()=>U(),onError:()=>V(),onFinish:()=>{}}):t.post(route("invoice.store"),{preserveScroll:!0,onSuccess:()=>U(),onError:()=>V(),onFinish:()=>{}})},V=()=>{},U=()=>{j.value=!1,t.reset()},W=r=>{t.items.splice(r,1),S()},S=()=>{t.subtotal=0,t.items.forEach(r=>{t.subtotal+=parseFloat(r.total)}),t.total=t.subtotal},P=r=>{const l=t.items[r],o=l.qty*l.amount;l.total=o,S()},R=r=>{K.get(`/users/fetch/shipper/${r}`).then(({data:l})=>{N=l.selected_shipper})},L=r=>{K.get(`/users/fetch/consignee/${r}`).then(({data:l})=>{q=l.selected_consignee})},I=F(null),D=r=>{I.value.edit(r)};return J(()=>{x||(t.items=[{particular:"",amount:0,qty:1,total:0}]),x&&S(),R(t.shipper_id),L(t.consignee_id)}),(r,l)=>(c(),_(b,null,[a(s(X),{title:"Invoices"}),a(z,null,{default:g(()=>[e("div",ee,[e("div",te,[e("div",se,[oe,e("div",le,[e("nav",ne,[e("ol",ae,[re,e("li",de,u(s(x)?"Create":"Edit"),1)])])]),ie]),e("div",ce,[e("form",{onSubmit:l[20]||(l[20]=Y(o=>Q(),["prevent"]))},[e("div",ue,[e("div",me,[e("div",_e,[pe,fe,s(v)=="invoice"?(c(),_("div",he,[a(m,{for:"",value:"Invoice Date",class:"mb-1"}),a(s(E),{modelValue:s(t).invoice_at,"onUpdate:modelValue":l[0]||(l[0]=o=>s(t).invoice_at=o),teleport:!0},null,8,["modelValue"]),a(i,{message:s(t).errors.invoice_at},null,8,["message"])])):w("",!0),e("div",ge,[a(m,{for:"",value:"Company Account",class:"mb-1"}),d(e("select",{class:"form-control","onUpdate:modelValue":l[1]||(l[1]=o=>s(t).company_id=o),onChange:l[2]||(l[2]=o=>r.fetchAddress("company"))},[(c(!0),_(b,null,A(y.companies,o=>(c(),_("option",{key:o.id,value:o.id},u(o.id)+" - "+u(o.name),9,ve))),128))],544),[[T,s(t).company_id]]),a(i,{message:s(t).errors.company_id},null,8,["message"])]),e("div",be,[a(m,{for:"",value:"MAWB No",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[3]||(l[3]=o=>s(t).mawb_no=o)},null,512),[[p,s(t).mawb_no]]),a(i,{message:s(t).errors.mawb_no},null,8,["message"])]),e("div",ye,[a(m,{for:"",value:"Carrier",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[4]||(l[4]=o=>s(t).carrier=o)},null,512),[[p,s(t).carrier]]),a(i,{message:s(t).errors.carrier},null,8,["message"])])]),xe,e("div",Ve,[e("div",Ue,[Ce,we,e("div",Ae,[e("div",Se,[e("label",Ie,[f("Account Number "),a(G,{roles:y.roles,ref_key:"create_edit_ref",ref:I},null,8,["roles"]),a($,{onClick:l[5]||(l[5]=o=>D(s(N))),type:"button"},{default:g(()=>[f("Edit "),ke]),_:1})]),d(e("select",{class:"form-control","onUpdate:modelValue":l[6]||(l[6]=o=>s(t).shipper_id=o),onChange:l[7]||(l[7]=o=>R(s(t).shipper_id))},[(c(!0),_(b,null,A(y.shippers,o=>(c(),_("option",{key:o.id,value:o.id},u(o.id)+" - "+u(o.name),9,Te))),128))],544),[[T,s(t).shipper_id]]),a(i,{message:s(t).errors.shipper_id},null,8,["message"])])])]),e("div",$e,[Ee,Ne,e("div",qe,[e("div",Pe,[e("label",Re,[f("Account Number "),a(G,{roles:y.roles,ref_key:"create_edit_ref",ref:I},null,8,["roles"]),a($,{onClick:l[8]||(l[8]=o=>D(s(q))),type:"button"},{default:g(()=>[f("Edit "),Le]),_:1})]),d(e("select",{class:"form-control","onUpdate:modelValue":l[9]||(l[9]=o=>s(t).consignee_id=o),onChange:l[10]||(l[10]=o=>L(s(t).consignee_id))},[(c(!0),_(b,null,A(y.consignees,o=>(c(),_("option",{key:o.id,value:o.id},u(o.id)+" - "+u(o.name),9,De))),128))],544),[[T,s(t).consignee_id]]),a(i,{message:s(t).errors.consignee_id},null,8,["message"])])])])]),Fe,e("div",Ke,[Me,Be,e("div",Oe,[a(m,{for:"",value:"Departure Date",class:"mb-1"}),a(s(E),{modelValue:s(t).departure_at,"onUpdate:modelValue":l[11]||(l[11]=o=>s(t).departure_at=o),teleport:!0},null,8,["modelValue"]),a(i,{message:s(t).errors.departure_at},null,8,["message"])]),e("div",Ge,[a(m,{for:"",value:"Landing Date",class:"mb-1"}),a(s(E),{modelValue:s(t).landing_at,"onUpdate:modelValue":l[12]||(l[12]=o=>s(t).landing_at=o),teleport:!0},null,8,["modelValue"]),a(i,{message:s(t).errors.landing_at},null,8,["message"])]),e("div",je,[a(m,{for:"",value:"Port of Departure",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[13]||(l[13]=o=>s(t).sender=o)},null,512),[[p,s(t).sender]]),a(i,{message:s(t).errors.sender},null,8,["message"])]),e("div",He,[a(m,{for:"",value:"Port of Landing",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[14]||(l[14]=o=>s(t).destination=o)},null,512),[[p,s(t).destination]]),a(i,{message:s(t).errors.destination},null,8,["message"])]),e("div",Qe,[a(m,{for:"",value:"Commodity",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[15]||(l[15]=o=>s(t).commodity=o)},null,512),[[p,s(t).commodity]]),a(i,{message:s(t).errors.commodity},null,8,["message"])]),e("div",We,[a(m,{for:"",value:"Quantity",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[16]||(l[16]=o=>s(t).quantity=o)},null,512),[[p,s(t).quantity]]),a(i,{message:s(t).errors.quantity},null,8,["message"])]),e("div",Ze,[a(m,{for:"",value:"Weight",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[17]||(l[17]=o=>s(t).weight=o)},null,512),[[p,s(t).weight]]),a(i,{message:s(t).errors.weight},null,8,["message"])]),e("div",Je,[a(m,{for:"",value:"AFC Rate/KG",class:"mb-1"}),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[18]||(l[18]=o=>s(t).afc_rate=o)},null,512),[[p,s(t).afc_rate]]),a(i,{message:s(t).errors.afc_rate},null,8,["message"])])]),s(v)=="invoice"?(c(),_(b,{key:0},[Xe,Ye,ze,e("table",null,[e("thead",null,[e("tr",null,[e("th",null,[e("button",{type:"button",onClick:l[19]||(l[19]=o=>H()),class:"ms-1 text-sucess btn btn-success btn-sm"},[et,f("Add Item")])]),tt,st,ot,lt])]),e("tbody",null,[(c(!0),_(b,null,A(s(t).items,(o,C)=>(c(),_("tr",{key:o.id},[e("td",nt,[e("span",null,[f(" Item #"+u(C)+" ",1),e("button",{type:"button",onClick:h=>W(C),class:"ms-1 text-danger"},dt,8,at)])]),e("td",it,[d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":h=>o.particular=h},null,8,ct),[[p,o.particular]])]),e("td",ut,[d(e("input",{type:"number",class:"form-control","onUpdate:modelValue":h=>o.amount=h,onKeyup:h=>P(C)},null,40,mt),[[p,o.amount]])]),e("td",_t,[d(e("input",{type:"number",class:"form-control","onUpdate:modelValue":h=>o.qty=h,onKeyup:h=>P(C)},null,40,pt),[[p,o.qty]])]),e("td",ft,"PKR "+u(o.total),1)]))),128))]),e("tfoot",null,[e("tr",null,[ht,gt,e("td",null,"PKR "+u(s(t).subtotal),1)]),e("tr",null,[vt,bt,e("td",null,"PKR "+u(s(t).total),1)])])])],64)):w("",!0)])]),e("div",yt,[e("div",xt,[a($,{disabled:s(t).processing},{default:g(()=>[f(u(s(x)?"Update":"Save"),1)]),_:1},8,["disabled"]),s(v)=="shipment"?(c(),M(s(B),{key:0,href:r.route("shipment.index")},{default:g(()=>[a(O,{disabled:s(t).processing},{default:g(()=>[f(" Cancel ")]),_:1},8,["disabled"])]),_:1},8,["href"])):w("",!0),s(v)=="invoice"?(c(),M(s(B),{key:1,href:r.route("invoice.index")},{default:g(()=>[a(O,{disabled:s(t).processing},{default:g(()=>[f(" Cancel ")]),_:1},8,["disabled"])]),_:1},8,["href"])):w("",!0)])])],32)])])])]),_:1})],64))}};export{Et as default};
